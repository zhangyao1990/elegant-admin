
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import{_ as N}from"./index-qeCTDZwl.js";import{d as j,bo as g,bM as O,r as P,ai as r,a as p,c as m,_ as t,U as f,S as v,O as c,f as a,a3 as w,V as A,k as h,$ as D,X as _}from"./@vue-B5ZJ3lyG.js";import{a as y}from"./element-plus-iUOJk6xm.js";import{_ as L}from"./vue-esign-CYl9_Ryz.js";const R={class:"upload-container"},T={key:1,class:"image"},X={class:"mask"},q={class:"actions"},F={key:0,class:"el-upload__tip"},G={style:{display:"inline-block"}},H=j({name:"ImageUpload",__name:"index",props:g({action:{},headers:{},data:{},name:{default:"file"},size:{default:2},width:{default:150},height:{default:150},placeholder:{default:""},notip:{type:Boolean,default:!1},ext:{default:()=>["jpg","png","gif","bmp"]}},{modelValue:{default:""},modelModifiers:{}}),emits:g(["onSuccess"],["update:modelValue"]),setup(u,{emit:$}){const d=u,V=$,o=O(u,"modelValue"),s=P({imageViewerVisible:!1,progress:{preview:"",percent:0}});function b(){s.value.imageViewerVisible=!0}function k(){s.value.imageViewerVisible=!1}function E(){o.value=""}const M=e=>{const l=e.name.split(".").at(-1)??"",i=d.ext.includes(l),n=e.size/1024/1024<d.size;return i||y.error(`上传图片只支持 ${d.ext.join(" / ")} 格式！`),n||y.error(`上传图片大小不能超过 ${d.size}MB！`),i&&n&&(s.value.progress.preview=URL.createObjectURL(e)),i&&n},z=e=>{s.value.progress.percent=~~e.percent},C=e=>{s.value.progress.preview="",s.value.progress.percent=0,V("onSuccess",e)};return(e,S)=>{const l=N,i=r("ElImage"),n=r("ElProgress"),B=r("ElUpload"),I=r("ElAlert"),U=r("ElImageViewer");return p(),m("div",R,[t(B,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":M,"on-progress":z,"on-success":C,drag:"",class:"image-upload"},{default:f(()=>[o.value===""?(p(),v(i,{key:0,src:o.value===""?e.placeholder:o.value,style:c(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},{error:f(()=>[a("div",{class:"image-slot",style:c(`width:${e.width}px;height:${e.height}px;`)},[t(l,{name:"ep:plus",class:"icon"})],4)]),_:1},8,["src","style"])):(p(),m("div",T,[t(i,{src:o.value,style:c(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),a("div",X,[a("div",q,[a("span",{title:"预览",onClick:w(b,["stop"])},[t(l,{name:"ep:zoom-in",class:"icon"})]),a("span",{title:"移除",onClick:w(E,["stop"])},[t(l,{name:"ep:delete",class:"icon"})])])])])),A(a("div",{class:"progress",style:c(`width:${e.width}px;height:${e.height}px;`)},[t(i,{src:h(s).progress.preview,style:c(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),t(n,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:h(s).progress.percent},null,8,["width","percentage"])],4),[[D,o.value===""&&h(s).progress.percent]])]),_:1},8,["headers","action","data","name"]),e.notip?_("",!0):(p(),m("div",F,[a("div",G,[t(I,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，且图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),h(s).imageViewerVisible?(p(),v(U,{key:1,"url-list":[o.value],teleported:"",onClose:k},null,8,["url-list"])):_("",!0)])}}}),Y=L(H,[["__scopeId","data-v-eb8db6d9"]]);export{Y as _};
