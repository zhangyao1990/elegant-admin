
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import{_ as G}from"./index.vue_vue_type_script_setup_true_lang-RB9jAAaE.js";import{_ as H}from"./index-3XUE9bg5.js";import{_ as J}from"./index-D1xER_q_.js";import{_ as K}from"./index-qeCTDZwl.js";import{a as Q,e as ee}from"./sys_menu-CbQ8rWqJ.js";import{g as le}from"./sys_resource-gOgi4MrX.js";import{e as te}from"./lodash-es-Cgwu3vQX.js";import{a as T}from"./element-plus-iUOJk6xm.js";import{d as oe,r as V,w as ae,o as ne,l as se,ai as i,a as g,c as F,f as d,Z as ue,_ as l,U as a,Y as u,S as A,X as B,k as E,F as me}from"./@vue-B5ZJ3lyG.js";import{_ as ie}from"./vue-esign-CYl9_Ryz.js";import"./index.vue_vue_type_script_setup_true_lang-D6S2Ky_O.js";import"./@element-plus-DlsPF3Ud.js";import"./sortablejs-BWWsmqBL.js";import"./@imengyu-CEcZjhxx.js";import"./vue-DvVlWPqX.js";import"./GridItem.vue_vue_type_script_setup_true_lang-DQ62nwkd.js";import"./monaco-editor-1i8roCpp.js";import"./vite-plugin-fake-server-4rIte7rE.js";import"./mockjs-CyY_Wk_H.js";import"./floating-vue-AocVffS4.js";import"./@floating-ui-DiM7Jq06.js";import"./vue-m-message-CaZYo5LC.js";import"./overlayscrollbars-DIcyBJd7.js";import"./@iconify-BcJ8VpTk.js";import"./overlayscrollbars-vue-CwvYLriB.js";import"./@headlessui-Cgia3ZxR.js";import"./mitt-DJ65BbbF.js";import"./crypto-js-0jcLrwUI.js";import"./pinia-C6gN_FJk.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-B53joON4.js";import"./hotkeys-js-BfWqkGRU.js";import"./vue-i18n-BoS7Exf_.js";import"./@intlify-CEEhciFb.js";import"./colord-CrBFWQzZ.js";import"./path-browserify-CaPOtSVJ.js";import"./axios-CRnBnh7r.js";import"./@vueuse-D9pgrdqz.js";import"./nprogress-CK9xi7fq.js";import"./@sxzz-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-DHZ_rfNz.js";import"./async-validator-CRbnkQr6.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";const re={class:"mb-4 pt-2"},pe={class:"px-3 py-1.2 text-16px font-500"},de={class:"mx-2 mt-2"},fe={class:"flex-1 overflow-auto px-4 py-2"},ce={key:0},ve={key:1},_e={class:"flex items-center"},be={class:"flex items-center"},Ve={class:"flex items-center"},ye={class:"flex items-center"},ge={class:"flex items-center"},xe={class:"menu-footer h-14 flex items-center justify-center"},ke=oe({name:"MenuDetail",__name:"menuDetail",props:{menuTreeList:{default:[]}},emits:["success"],setup(N,{expose:R,emit:$}){const C=N,D=$,L=V("add"),y=V(!1),S=V(!1),j=V({"meta.title":[{required:!0,message:"请输入显示名称"}],"meta.iframe":[{required:!0,message:"请输入iframe地址"}],"meta.link":[{required:!0,message:"请输入外链地址"}],"meta.type":[{required:!0,message:"请选择菜单类型"}],name:[{required:!0,message:"请输入别名"}],sort:[{required:!0,message:"请输入排序"}]}),q=V([]),o=V({});ae(()=>C.menuTreeList,t=>{q.value=[{children:P(t),label:"顶级菜单",value:"0"}]},{deep:!0}),ne(()=>{O()});function O(){o.value={id:"",pid:"",name:"",path:"",component:"",redirect:"",sort:1,meta:{title:"",icon:"",activeMenu:"",type:"",menu:!1,breadcrumb:!1,cache:!1,threeMenu:!1,isFull:!1,link:"",iframe:""},apiPermissionsIdList:[]},q.value=[{children:P(C.menuTreeList),label:"顶级菜单",value:"0"}]}function P(t){const e=[];return t&&t.forEach(m=>{let r={value:m.id,pid:m.pid,label:m.meta&&m.meta.title||"",children:m.children&&m.children.length>0?P(m.children):null};e.push(r)}),e}const h=V();async function z(){h.value.validate(async t=>{if(t){y.value=!0;try{let e=te(o.value),m=[];if(e.apiPermissionsIdList&&e.apiPermissionsIdList.map(r=>{m.push(r.value)}),e.apiPermissionsIdList=m,e.id=e.id.includes("menuId-")?"":e.id,L.value==="add"){let r=await Q(e);y.value=!1,r.code===200&&(D("success",e),T.success({message:"操作成功!",showClose:!0,duration:1e3}))}else{let r=await ee(e);y.value=!1,r.code===200&&(D("success",e),T.success({message:"操作成功!",showClose:!0,duration:1e3}))}}catch{y.value=!1}}else return!1})}async function W(t,e,m="add"){var b,x,s,p,f,c,v,k,w,_,M,U;if(L.value=m,S.value=!0,m==="add"){o.value=Object.assign({},t),o.value.pid=e;return}o.value={id:t.id,pid:e,name:t.name,path:t.path,component:t.component,redirect:t.redirect,sort:t.sort||1,meta:{title:(b=t==null?void 0:t.meta)==null?void 0:b.title,icon:((x=t==null?void 0:t.meta)==null?void 0:x.icon)||"",activeMenu:(s=t==null?void 0:t.meta)==null?void 0:s.activeMenu,type:(p=t==null?void 0:t.meta)==null?void 0:p.type,menu:(f=t==null?void 0:t.meta)==null?void 0:f.menu,breadcrumb:(c=t==null?void 0:t.meta)==null?void 0:c.breadcrumb,cache:(v=t==null?void 0:t.meta)==null?void 0:v.cache,threeMenu:(k=t==null?void 0:t.meta)==null?void 0:k.threeMenu,isFull:(w=t==null?void 0:t.meta)==null?void 0:w.isFull,link:(_=t==null?void 0:t.meta)==null?void 0:_.link,iframe:(M=t==null?void 0:t.meta)==null?void 0:M.iframe},apiPermissionsIdList:t.apiPermissions||[]};let r=[];(U=t.apiPermissions)==null||U.forEach(I=>{r.push({value:I.id,label:I.name})}),o.value.apiPermissionsIdList=r||[]}const X=se([{type:"selection",fixed:"left",width:80},{type:"index",label:"#",width:60},{prop:"name",label:"资源名称",minWidth:100,search:{el:"input"}}]);return R({acceptParams:W}),(t,e)=>{const m=i("el-divider"),r=i("el-empty"),b=i("el-radio-button"),x=i("el-radio-group"),s=i("el-form-item"),p=i("el-input"),f=K,c=i("el-icon"),v=i("el-tooltip"),k=i("el-tree-select"),w=J,_=i("el-checkbox"),M=i("el-input-number"),U=H,I=i("el-form"),Y=i("el-button"),Z=G;return g(),F(me,null,[d("div",re,[d("div",pe,ue(`${L.value==="add"?"新增":"编辑"}-${o.value.meta&&o.value.meta.title}`),1),d("div",de,[l(m,{"border-style":"dashed",class:"m-0 w-full"})])]),d("div",fe,[S.value?(g(),F("div",ve,[l(I,{ref_key:"menuDetailFormRef",ref:h,class:"grid grid-cols-2 gap-x-20 gap-y-2",model:o.value,rules:j.value,"label-width":"120px","label-position":"left"},{default:a(()=>[l(s,{label:"菜单类型:",prop:"meta.type",class:"col-span-2"},{default:a(()=>[l(x,{modelValue:o.value.meta.type,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.meta.type=n),onChange:e[1]||(e[1]=()=>{o.value.meta.iframe=null,o.value.meta.link=null})},{default:a(()=>[l(b,{value:"menu"},{default:a(()=>e[19]||(e[19]=[u(" 菜单 ")])),_:1}),l(b,{value:"iframe"},{default:a(()=>e[20]||(e[20]=[u(" Iframe ")])),_:1}),l(b,{value:"link"},{default:a(()=>e[21]||(e[21]=[u(" 外链 ")])),_:1}),l(b,{value:"button"},{default:a(()=>e[22]||(e[22]=[u(" 按钮 ")])),_:1})]),_:1},8,["modelValue"])]),_:1}),o.value.meta.type==="iframe"?(g(),A(s,{key:0,label:"Iframe地址:",prop:"meta.iframe"},{default:a(()=>[l(p,{modelValue:o.value.meta.iframe,"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.meta.iframe=n),clearable:"",placeholder:"请输入Iframe地址"},null,8,["modelValue"])]),_:1})):B("",!0),o.value.meta.type==="link"?(g(),A(s,{key:1,label:"外链地址:",prop:"meta.link"},{default:a(()=>[l(p,{modelValue:o.value.meta.link,"onUpdate:modelValue":e[3]||(e[3]=n=>o.value.meta.link=n),clearable:"",placeholder:"请输入外链地址"},null,8,["modelValue"])]),_:1})):B("",!0),l(s,{label:"菜单名称:",prop:"meta.title"},{default:a(()=>[l(p,{modelValue:o.value.meta.title,"onUpdate:modelValue":e[4]||(e[4]=n=>o.value.meta.title=n),maxlength:"50",clearable:"",placeholder:"菜单显示名字"},null,8,["modelValue"])]),_:1}),l(s,{prop:"name"},{label:a(()=>[d("div",_e,[e[23]||(e[23]=u(" 别名: ")),l(v,{content:"<div class='w-40'>系统唯一且与内置组件名一致，否则导致缓存失效。如类型为Iframe的菜单，别名将代替源地址显示在地址栏</span>","raw-content":""},{default:a(()=>[l(c,null,{default:a(()=>[l(f,{name:"ep:question-filled"})]),_:1})]),_:1})])]),default:a(()=>[l(p,{modelValue:o.value.name,"onUpdate:modelValue":e[5]||(e[5]=n=>o.value.name=n),maxlength:"50",clearable:"",placeholder:"菜单别名"},null,8,["modelValue"])]),_:1}),l(s,{label:"上级菜单:",prop:"pid"},{default:a(()=>[l(k,{modelValue:o.value.pid,"onUpdate:modelValue":e[6]||(e[6]=n=>o.value.pid=n),data:q.value,"render-after-expand":!1,class:"w-full",placeholder:"顶级菜单",clearable:"","check-strictly":"","show-checkbox":"","check-on-click-node":""},null,8,["modelValue","data"])]),_:1}),l(s,{label:"菜单图标:",prop:"meta.icon"},{default:a(()=>[l(w,{modelValue:o.value.meta.icon,"onUpdate:modelValue":e[7]||(e[7]=n=>o.value.meta.icon=n)},null,8,["modelValue"])]),_:1}),l(s,{label:"是否缓存:",prop:"meta.cache"},{default:a(()=>[l(_,{modelValue:o.value.meta.cache,"onUpdate:modelValue":e[8]||(e[8]=n=>o.value.meta.cache=n)},{default:a(()=>e[24]||(e[24]=[u(" 是否缓存 ")])),_:1},8,["modelValue"])]),_:1}),l(s,{label:"路由地址:",prop:"path"},{default:a(()=>[l(p,{modelValue:o.value.path,"onUpdate:modelValue":e[9]||(e[9]=n=>o.value.path=n),clearable:"",placeholder:""},null,8,["modelValue"])]),_:1}),l(s,{label:"是否三级路由:",prop:"meta.threeMenu"},{label:a(()=>[d("div",be,[e[25]||(e[25]=u(" 是否三级路由: ")),l(v,{content:"<div class='w-40'>非特殊情况不勾选</span>","raw-content":""},{default:a(()=>[l(c,null,{default:a(()=>[l(f,{name:"ep:question-filled"})]),_:1})]),_:1})])]),default:a(()=>[l(_,{modelValue:o.value.meta.threeMenu,"onUpdate:modelValue":e[10]||(e[10]=n=>o.value.meta.threeMenu=n)},{default:a(()=>e[26]||(e[26]=[u(" 是否三级路由 ")])),_:1},8,["modelValue"])]),_:1}),l(s,{label:"菜单是否全屏:",prop:"meta.isFull"},{default:a(()=>[l(_,{modelValue:o.value.meta.isFull,"onUpdate:modelValue":e[11]||(e[11]=n=>o.value.meta.isFull=n)},{default:a(()=>e[27]||(e[27]=[u(" 菜单是否全屏 ")])),_:1},8,["modelValue"])]),_:1}),l(s,{label:"重定向:",prop:"redirect"},{default:a(()=>[l(p,{modelValue:o.value.redirect,"onUpdate:modelValue":e[12]||(e[12]=n=>o.value.redirect=n),clearable:"",placeholder:""},null,8,["modelValue"])]),_:1}),l(s,{prop:"activeMenu"},{label:a(()=>[d("div",Ve,[e[28]||(e[28]=u(" 菜单高亮: ")),l(v,{content:"<div class='w-40'>子节点或详情页需要高亮的上级菜单路由地址</span>","raw-content":""},{default:a(()=>[l(c,null,{default:a(()=>[l(f,{name:"ep:question-filled"})]),_:1})]),_:1})])]),default:a(()=>[l(p,{modelValue:o.value.meta.activeMenu,"onUpdate:modelValue":e[13]||(e[13]=n=>o.value.meta.activeMenu=n),clearable:"",placeholder:""},null,8,["modelValue"])]),_:1}),l(s,{label:"排序:",prop:"sort"},{default:a(()=>[l(M,{modelValue:o.value.sort,"onUpdate:modelValue":e[14]||(e[14]=n=>o.value.sort=n),"controls-position":"right",max:1e4,min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(s,{prop:"component",class:"col-span-2"},{label:a(()=>[d("div",ye,[e[29]||(e[29]=u(" 视图: ")),l(v,{content:"<div class='w-40'>如父节点、外链或Iframe等没有视图的菜单填写LinkLayout</span>","raw-content":""},{default:a(()=>[l(c,null,{default:a(()=>[l(f,{name:"ep:question-filled"})]),_:1})]),_:1})])]),default:a(()=>[l(p,{modelValue:o.value.component,"onUpdate:modelValue":e[15]||(e[15]=n=>o.value.component=n),clearable:"",placeholder:""},{prepend:a(()=>e[30]||(e[30]=[u(" views/ ")])),_:1},8,["modelValue"])]),_:1}),l(s,{prop:"meta.menu",class:"col-span-2"},{label:a(()=>[d("div",ge,[e[31]||(e[31]=u(" 是否显示: ")),l(v,{content:"<div class='w-40'>菜单不显示在导航中，例如详情页</span>","raw-content":""},{default:a(()=>[l(c,null,{default:a(()=>[l(f,{name:"ep:question-filled"})]),_:1})]),_:1})])]),default:a(()=>[l(_,{modelValue:o.value.meta.menu,"onUpdate:modelValue":e[16]||(e[16]=n=>o.value.meta.menu=n)},{default:a(()=>e[32]||(e[32]=[u(" 显示菜单 ")])),_:1},8,["modelValue"]),l(_,{modelValue:o.value.meta.breadcrumb,"onUpdate:modelValue":e[17]||(e[17]=n=>o.value.meta.breadcrumb=n)},{default:a(()=>e[33]||(e[33]=[u(" 显示面包屑 ")])),_:1},8,["modelValue"])]),_:1}),l(s,{label:"接口权限:",prop:"apiPermissionsIdList",class:"col-span-2"},{default:a(()=>[l(U,{modelValue:o.value.apiPermissionsIdList,"onUpdate:modelValue":e[18]||(e[18]=n=>o.value.apiPermissionsIdList=n),multiple:"",columns:E(X),"request-api":E(le),"table-props":{label:"name",value:"id"}},null,8,["modelValue","columns","request-api"])]),_:1})]),_:1},8,["model","rules"])])):(g(),F("div",ce,[l(r,{description:"请选择左侧菜单后操作","image-size":100})]))]),d("div",xe,[l(Z,{value:["add:menu:btn"]},{default:a(()=>[l(Y,{type:"primary",loading:y.value,onClick:z},{default:a(()=>e[34]||(e[34]=[u(" 保 存 ")])),_:1},8,["loading"])]),_:1})])],64)}}}),cl=ie(ke,[["__scopeId","data-v-b84e7a27"]]);export{cl as default};
