
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import{v as O}from"./index-qeCTDZwl.js";import{_ as q,j as k}from"./index-CN3V1Hei.js";import{_ as T}from"./icon.vue_vue_type_script_setup_true_lang-Ct1VJFCF.js";import{d as B,b as P,i as F,a,c as i,F as v,a8 as x,f as m,Z as U,_ as b,k as g,X as $,r as C,w as I,S as N,U as R,Y as E}from"./@vue-B5ZJ3lyG.js";import"./vite-plugin-fake-server-4rIte7rE.js";import"./mockjs-CyY_Wk_H.js";import"./@imengyu-CEcZjhxx.js";import"./vue-DvVlWPqX.js";import"./floating-vue-AocVffS4.js";import"./@floating-ui-DiM7Jq06.js";import"./vue-m-message-CaZYo5LC.js";import"./overlayscrollbars-DIcyBJd7.js";import"./@iconify-BcJ8VpTk.js";import"./overlayscrollbars-vue-CwvYLriB.js";import"./@headlessui-Cgia3ZxR.js";import"./mitt-DJ65BbbF.js";import"./crypto-js-0jcLrwUI.js";import"./lodash-es-Cgwu3vQX.js";import"./pinia-C6gN_FJk.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-B53joON4.js";import"./hotkeys-js-BfWqkGRU.js";import"./element-plus-iUOJk6xm.js";import"./@vueuse-D9pgrdqz.js";import"./nprogress-CK9xi7fq.js";import"./@element-plus-DlsPF3Ud.js";import"./@sxzz-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-DHZ_rfNz.js";import"./async-validator-CRbnkQr6.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./vue-i18n-BoS7Exf_.js";import"./@intlify-CEEhciFb.js";import"./colord-CrBFWQzZ.js";import"./monaco-editor-1i8roCpp.js";import"./path-browserify-CaPOtSVJ.js";import"./axios-CRnBnh7r.js";import"./vue-esign-CYl9_Ryz.js";const j=[{label:"string",value:"string"},{label:"number",value:"number"},{label:"boolean",value:"boolean"},{label:"method",value:"method"},{label:"regexp",value:"regexp"},{label:"integer",value:"integer"},{label:"float",value:"float"},{label:"array",value:"array"},{label:"object",value:"object"},{label:"date",value:"date"},{label:"url",value:"url"},{label:"hex",value:"hex"},{label:"email",value:"email"},{label:"any",value:"any"}],D=[{label:"change",value:"change"},{label:"blur",value:"blur"}],w=["string","number","url","array","email"],M={class:"rule-item-main hover:border-primary relative m-t-2 border border-gray-200 rounded border-solid bg-white p-2 transition-all"},A={key:0,class:"m-t-2 flex first:m-0"},L={class:"elegant-attr-label",title:"校验时机"},X={class:"elegant-attr-input"},Y=B({__name:"ERuleItem",props:{rule:{}},emits:["change","delete","update:rule"],setup(y,{emit:f}){const c=y,p=f,o=P({get(){return c.rule},set(e){p("update:rule",e)}}),r=F("pageManager",{}),_=P(()=>Object.entries(r.funcs.value).filter(([e,n])=>typeof n=="function").map(([e])=>({label:e,value:e}))),t=[{type:"select",label:"校验时机",model:"trigger",componentProps:{options:D,placeholder:"校验时机",multiple:!0,mode:"multiple"}},{type:"switch",label:"自定义规则",model:"isValidator"},{type:"select",label:"校验函数",model:"validator",show(){return!!o.value.isValidator},componentProps:{options:_.value,placeholder:"校验函数"}},{type:"select",label:"类型",model:"type",show(){return!o.value.isValidator},componentProps:{options:j,placeholder:"类型"}},{type:"input",label:"正则校验",model:"pattern",show(){return!o.value.isValidator},componentProps:{placeholder:"正则校验"}},{type:"number",label:"字段长度",model:"len",show(){return w.includes(o.value.type??"")},componentProps:{min:0,placeholder:"字段长度"}},{type:"number",label:"最小长度",model:"min",show(){return w.includes(o.value.type??"")},componentProps:{min:0,placeholder:"最小长度"}},{type:"number",label:"最大长度",model:"max",show(){return w.includes(o.value.type??"")},componentProps:{min:0,placeholder:"最大长度"}},{type:"input",label:"校验信息",model:"message",componentProps:{placeholder:"校验信息"}}];function V(){const e=o.value;e.isValidator?(delete e.type,delete e.pattern,delete e.len,delete e.min,delete e.max):delete e.validator,p("change",e)}function d(){p("delete")}return(e,n)=>(a(),i("div",M,[(a(),i(v,null,x(t,(l,u)=>(a(),i(v,{key:u},[!l.show||l.show()?(a(),i("div",A,[m("div",L,U(l.label),1),m("div",X,[b(g(q),{modelValue:o.value[l.model],"onUpdate:modelValue":s=>o.value[l.model]=s,"component-schema":{...l,noFormItem:!0},onChange:V},null,8,["modelValue","onUpdate:modelValue","component-schema"])])])):$("",!0)],64))),64)),m("div",{class:"rule-btn-delete text-md absolute right-0 top-0 h-24px w-24px flex cursor-pointer items-center justify-center rounded-bl-2 color-white transition-all",onClick:d},[b(g(T),{name:"icon--elegant--delete-outline-rounded"})])]))}}),Z={class:"rule-item-main relative m-t-2 border rounded border-solid p-2 transition-all"},z={key:0,class:"m-t-2 flex first:m-0"},G={class:"elegant-attr-label"},H={class:"flex-1"},Te=B({__name:"index",props:{ruleType:{type:String,default:"string"},modelValue:{type:Array,default:void 0}},emits:["update:modelValue"],setup(y,{emit:f}){const c=y,p=f,o=O.getComponent("button"),r=C({required:!1,message:"必填项",type:c.ruleType,trigger:["change"]}),_=[{type:"switch",label:"必填项",model:"required"},{type:"select",label:"校验时机",model:"trigger",show(){return!!r.value.required},componentProps:{options:D,placeholder:"校验时机",multiple:!0,mode:"multiple"}},{type:"select",label:"类型",model:"type",show(){return!!r.value.required},componentProps:{options:j,placeholder:"类型"}},{type:"input",label:"校验信息",model:"message",show(){return!!r.value.required},componentProps:{placeholder:"校验信息"}}],t=C([]);I(()=>c.modelValue,n=>{if(n){if(!n)return;t.value=[],n.forEach(l=>{typeof l.required<"u"?r.value=l:t.value.push(l)})}},{immediate:!0});function V(){t.value.push({message:"",type:c.ruleType,trigger:["change"]}),d()}function d(){if(r.value.required){p("update:modelValue",k([...t.value,r.value]));return}if(t.value.length){p("update:modelValue",k(t.value));return}p("update:modelValue",void 0)}function e(n){t.value.splice(n,1),d()}return(n,l)=>(a(),i("div",null,[m("div",Z,[(a(),i(v,null,x(_,(u,s)=>(a(),i(v,{key:s},[!u.show||u.show()?(a(),i("div",z,[m("div",G,U(u.label),1),m("div",H,[b(g(q),{modelValue:r.value[u.model],"onUpdate:modelValue":h=>r.value[u.model]=h,"component-schema":{...u,noFormItem:!0},onChange:d},null,8,["modelValue","onUpdate:modelValue","component-schema"])])])):$("",!0)],64))),64))]),(a(!0),i(v,null,x(t.value,(u,s)=>(a(),N(Y,{key:s,rule:t.value[s],"onUpdate:rule":h=>t.value[s]=h,onDelete:h=>e(s),onChange:d},null,8,["rule","onUpdate:rule","onDelete"]))),128)),b(g(o),{class:"m-t-2",onClick:V},{default:R(()=>l[0]||(l[0]=[E(" 添加规则 ")])),_:1})]))}});export{Te as default};
