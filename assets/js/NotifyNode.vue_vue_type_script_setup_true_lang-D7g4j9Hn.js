
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import B from"./Node-DguPqMLY.js";import{d as U,i as k,r as d,g as w,ai as C,a as E,S as P,U as $,_ as D,Y as L,Z as R,k as S,Q as T}from"./@vue-B5ZJ3lyG.js";const Q=U({__name:"NotifyNode",props:{node:{}},setup(N){const u=N,{fields:m,nodesError:c}=k("flowDesign",{fields:d([]),nodesError:d({})}),s=d("");return w(()=>{var _,y;const e=[],{id:a,assigneeType:o,name:t,users:p,roles:g,leader:h,choice:b,formUser:r,formRole:i,orgLeader:v,subject:j,types:x}=u.node;if(o==="user")if(p.length>0){const n=p.map(l=>getByUsername(l));Promise.all(n).then(l=>{s.value=l.map(f=>f.data.name).join("、")})}else e.push({id:a,name:t,message:"未指定人员"}),s.value="未指定人员";else if(o==="choice")s.value=`发起人自选（${b?"多选":"单选"}）`;else if(o==="self")s.value="发起人自己";else if(o==="leader")s.value=h===1?"直属上级":`${h}级上级`;else if(o==="orgLeader")s.value=v===1?"直属主管":`${v}级主管`;else if(o==="formUser"){r||e.push({id:a,name:t,message:"未指定表单内人员"});const n=((_=m.value.find(l=>l.id===r))==null?void 0:_.label)||r||"?";s.value=`表单内（${n}）人员`}else if(o==="formRole"){i||e.push({id:a,name:t,message:"未指定表单内角色"});const n=((y=m.value.find(l=>l.id===i))==null?void 0:y.label)||i||"?";s.value=`表单内（${n}）角色`}else if(o==="role")if(g.length>0){const n=g.map(l=>getById(l));Promise.all(n).then(l=>{s.value=l.map(f=>f.data.name).join("、")})}else e.push({id:a,name:t,message:"未指定角色"}),s.value="未指定角色";else e.push({id:a,name:t,message:"未知错误"}),s.value=t;x.length===0&&e.push({id:a,name:t,message:"未指定通知类型"}),j||e.push({id:a,name:t,message:"消息主题为空"}),u.node.content||e.push({id:a,name:t,message:"消息内容为空"}),e.length>0?c.value[a]=e:delete c.value[a]}),(e,a)=>{const o=C("el-text");return E(),P(B,T(e.$attrs,{icon:"ep:bell-filled",color:"#95d475",node:e.node}),{default:$(()=>[D(o,null,{default:$(()=>[L(R(S(s)),1)]),_:1})]),_:1},16,["node"])}}});export{Q as _};
