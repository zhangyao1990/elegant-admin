
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import{E as be}from"./eventemitter3-Br74xS_E.js";function we(i,a){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);a&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function ae(i){for(var a=1;a<arguments.length;a++){var e=arguments[a]!=null?arguments[a]:{};a%2?we(Object(e),!0).forEach(function(t){c(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):we(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function k(){k=function(){return i};var i={},a=Object.prototype,e=a.hasOwnProperty,t=Object.defineProperty||function(h,l,_){h[l]=_.value},r=typeof Symbol=="function"?Symbol:{},n=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",u=r.toStringTag||"@@toStringTag";function s(h,l,_){return Object.defineProperty(h,l,{value:_,enumerable:!0,configurable:!0,writable:!0}),h[l]}try{s({},"")}catch{s=function(l,_,E){return l[_]=E}}function d(h,l,_,E){var v=l&&l.prototype instanceof y?l:y,O=Object.create(v.prototype),w=new te(E||[]);return t(O,"_invoke",{value:P(h,_,w)}),O}function m(h,l,_){try{return{type:"normal",arg:h.call(l,_)}}catch(E){return{type:"throw",arg:E}}}i.wrap=d;var f={};function y(){}function g(){}function T(){}var R={};s(R,n,function(){return this});var S=Object.getPrototypeOf,F=S&&S(S(L([])));F&&F!==a&&e.call(F,n)&&(R=F);var j=T.prototype=y.prototype=Object.create(R);function $(h){["next","throw","return"].forEach(function(l){s(h,l,function(_){return this._invoke(l,_)})})}function A(h,l){function _(v,O,w,M){var N=m(h[v],h,O);if(N.type!=="throw"){var C=N.arg,H=C.value;return H&&typeof H=="object"&&e.call(H,"__await")?l.resolve(H.__await).then(function(D){_("next",D,w,M)},function(D){_("throw",D,w,M)}):l.resolve(H).then(function(D){C.value=D,w(C)},function(D){return _("throw",D,w,M)})}M(N.arg)}var E;t(this,"_invoke",{value:function(v,O){function w(){return new l(function(M,N){_(v,O,M,N)})}return E=E?E.then(w,w):w()}})}function P(h,l,_){var E="suspendedStart";return function(v,O){if(E==="executing")throw new Error("Generator is already running");if(E==="completed"){if(v==="throw")throw O;return le()}for(_.method=v,_.arg=O;;){var w=_.delegate;if(w){var M=K(w,_);if(M){if(M===f)continue;return M}}if(_.method==="next")_.sent=_._sent=_.arg;else if(_.method==="throw"){if(E==="suspendedStart")throw E="completed",_.arg;_.dispatchException(_.arg)}else _.method==="return"&&_.abrupt("return",_.arg);E="executing";var N=m(h,l,_);if(N.type==="normal"){if(E=_.done?"completed":"suspendedYield",N.arg===f)continue;return{value:N.arg,done:_.done}}N.type==="throw"&&(E="completed",_.method="throw",_.arg=N.arg)}}}function K(h,l){var _=l.method,E=h.iterator[_];if(E===void 0)return l.delegate=null,_==="throw"&&h.iterator.return&&(l.method="return",l.arg=void 0,K(h,l),l.method==="throw")||_!=="return"&&(l.method="throw",l.arg=new TypeError("The iterator does not provide a '"+_+"' method")),f;var v=m(E,h.iterator,l.arg);if(v.type==="throw")return l.method="throw",l.arg=v.arg,l.delegate=null,f;var O=v.arg;return O?O.done?(l[h.resultName]=O.value,l.next=h.nextLoc,l.method!=="return"&&(l.method="next",l.arg=void 0),l.delegate=null,f):O:(l.method="throw",l.arg=new TypeError("iterator result is not an object"),l.delegate=null,f)}function X(h){var l={tryLoc:h[0]};1 in h&&(l.catchLoc=h[1]),2 in h&&(l.finallyLoc=h[2],l.afterLoc=h[3]),this.tryEntries.push(l)}function W(h){var l=h.completion||{};l.type="normal",delete l.arg,h.completion=l}function te(h){this.tryEntries=[{tryLoc:"root"}],h.forEach(X,this),this.reset(!0)}function L(h){if(h){var l=h[n];if(l)return l.call(h);if(typeof h.next=="function")return h;if(!isNaN(h.length)){var _=-1,E=function v(){for(;++_<h.length;)if(e.call(h,_))return v.value=h[_],v.done=!1,v;return v.value=void 0,v.done=!0,v};return E.next=E}}return{next:le}}function le(){return{value:void 0,done:!0}}return g.prototype=T,t(j,"constructor",{value:T,configurable:!0}),t(T,"constructor",{value:g,configurable:!0}),g.displayName=s(T,u,"GeneratorFunction"),i.isGeneratorFunction=function(h){var l=typeof h=="function"&&h.constructor;return!!l&&(l===g||(l.displayName||l.name)==="GeneratorFunction")},i.mark=function(h){return Object.setPrototypeOf?Object.setPrototypeOf(h,T):(h.__proto__=T,s(h,u,"GeneratorFunction")),h.prototype=Object.create(j),h},i.awrap=function(h){return{__await:h}},$(A.prototype),s(A.prototype,o,function(){return this}),i.AsyncIterator=A,i.async=function(h,l,_,E,v){v===void 0&&(v=Promise);var O=new A(d(h,l,_,E),v);return i.isGeneratorFunction(l)?O:O.next().then(function(w){return w.done?w.value:O.next()})},$(j),s(j,u,"Generator"),s(j,n,function(){return this}),s(j,"toString",function(){return"[object Generator]"}),i.keys=function(h){var l=Object(h),_=[];for(var E in l)_.push(E);return _.reverse(),function v(){for(;_.length;){var O=_.pop();if(O in l)return v.value=O,v.done=!1,v}return v.done=!0,v}},i.values=L,te.prototype={constructor:te,reset:function(h){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(W),!h)for(var l in this)l.charAt(0)==="t"&&e.call(this,l)&&!isNaN(+l.slice(1))&&(this[l]=void 0)},stop:function(){this.done=!0;var h=this.tryEntries[0].completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(h){if(this.done)throw h;var l=this;function _(N,C){return O.type="throw",O.arg=h,l.next=N,C&&(l.method="next",l.arg=void 0),!!C}for(var E=this.tryEntries.length-1;E>=0;--E){var v=this.tryEntries[E],O=v.completion;if(v.tryLoc==="root")return _("end");if(v.tryLoc<=this.prev){var w=e.call(v,"catchLoc"),M=e.call(v,"finallyLoc");if(w&&M){if(this.prev<v.catchLoc)return _(v.catchLoc,!0);if(this.prev<v.finallyLoc)return _(v.finallyLoc)}else if(w){if(this.prev<v.catchLoc)return _(v.catchLoc,!0)}else{if(!M)throw new Error("try statement without catch or finally");if(this.prev<v.finallyLoc)return _(v.finallyLoc)}}}},abrupt:function(h,l){for(var _=this.tryEntries.length-1;_>=0;--_){var E=this.tryEntries[_];if(E.tryLoc<=this.prev&&e.call(E,"finallyLoc")&&this.prev<E.finallyLoc){var v=E;break}}v&&(h==="break"||h==="continue")&&v.tryLoc<=l&&l<=v.finallyLoc&&(v=null);var O=v?v.completion:{};return O.type=h,O.arg=l,v?(this.method="next",this.next=v.finallyLoc,f):this.complete(O)},complete:function(h,l){if(h.type==="throw")throw h.arg;return h.type==="break"||h.type==="continue"?this.next=h.arg:h.type==="return"?(this.rval=this.arg=h.arg,this.method="return",this.next="end"):h.type==="normal"&&l&&(this.next=l),f},finish:function(h){for(var l=this.tryEntries.length-1;l>=0;--l){var _=this.tryEntries[l];if(_.finallyLoc===h)return this.complete(_.completion,_.afterLoc),W(_),f}},catch:function(h){for(var l=this.tryEntries.length-1;l>=0;--l){var _=this.tryEntries[l];if(_.tryLoc===h){var E=_.completion;if(E.type==="throw"){var v=E.arg;W(_)}return v}}throw new Error("illegal catch attempt")},delegateYield:function(h,l,_){return this.delegate={iterator:L(h),resultName:l,nextLoc:_},this.method==="next"&&(this.arg=void 0),f}},i}function Z(i){"@babel/helpers - typeof";return Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Z(i)}function Ae(i,a,e,t,r,n,o){try{var u=i[n](o),s=u.value}catch(d){e(d);return}u.done?a(s):Promise.resolve(s).then(t,r)}function V(i){return function(){var a=this,e=arguments;return new Promise(function(t,r){var n=i.apply(a,e);function o(s){Ae(n,t,r,o,u,"next",s)}function u(s){Ae(n,t,r,o,u,"throw",s)}o(void 0)})}}function B(i,a){if(!(i instanceof a))throw new TypeError("Cannot call a class as a function")}function Le(i,a){for(var e=0;e<a.length;e++){var t=a[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,Fe(t.key),t)}}function x(i,a,e){return a&&Le(i.prototype,a),e&&Le(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function c(i,a,e){return a=Fe(a),a in i?Object.defineProperty(i,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[a]=e,i}function ue(i,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(a&&a.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),a&&oe(i,a)}function ee(i){return ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ee(i)}function oe(i,a){return oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},oe(i,a)}function Ne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fe(i,a,e){return Ne()?fe=Reflect.construct.bind():fe=function(r,n,o){var u=[null];u.push.apply(u,n);var s=Function.bind.apply(r,u),d=new s;return o&&oe(d,o.prototype),d},fe.apply(null,arguments)}function Ge(i){return Function.toString.call(i).indexOf("[native code]")!==-1}function ve(i){var a=typeof Map=="function"?new Map:void 0;return ve=function(t){if(t===null||!Ge(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(typeof a<"u"){if(a.has(t))return a.get(t);a.set(t,r)}function r(){return fe(t,arguments,ee(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),oe(r,t)},ve(i)}function qe(i,a){if(i==null)return{};var e={},t=Object.keys(i),r,n;for(n=0;n<t.length;n++)r=t[n],!(a.indexOf(r)>=0)&&(e[r]=i[r]);return e}function $e(i,a){if(i==null)return{};var e=qe(i,a),t,r;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);for(r=0;r<n.length;r++)t=n[r],!(a.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(i,t)&&(e[t]=i[t])}return e}function p(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Ke(i,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p(i)}function ce(i){var a=Ne();return function(){var t=ee(i),r;if(a){var n=ee(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return Ke(this,r)}}function Ve(i,a){for(;!Object.prototype.hasOwnProperty.call(i,a)&&(i=ee(i),i!==null););return i}function _e(){return typeof Reflect<"u"&&Reflect.get?_e=Reflect.get.bind():_e=function(a,e,t){var r=Ve(a,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?a:t):n.value}},_e.apply(this,arguments)}function We(i,a){if(i){if(typeof i=="string")return De(i,a);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return De(i,a)}}function De(i,a){(a==null||a>i.length)&&(a=i.length);for(var e=0,t=new Array(a);e<a;e++)t[e]=i[e];return t}function ze(i,a){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=We(i))||a){e&&(i=e);var t=0,r=function(){};return{s:r,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(s){throw s},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var n=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var s=e.next();return n=s.done,s},e:function(s){o=!0,u=s},f:function(){try{!n&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Xe(i,a){if(typeof i!="object"||i===null)return i;var e=i[Symbol.toPrimitive];if(e!==void 0){var t=e.call(i,a||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(i)}function Fe(i){var a=Xe(i,"string");return typeof a=="symbol"?a:String(a)}var Q=function(){function i(){B(this,i)}return x(i,null,[{key:"start",value:function(e){return!e||!e.length||e.length===1&&e.end(0)-e.start(0)<1e-6||e.length===1&&e.start(0)<0?0:e.start(0)}},{key:"end",value:function(e){return!e||!e.length||e.length===1&&e.end(0)-e.start(0)<1e-6?0:e.end(e.length-1)}},{key:"get",value:function(e){if(e)try{return e.buffered}catch{}}},{key:"buffers",value:function(e,t){if(!e||!e.length)return[];for(var r=[],n=0,o=e.length;n<o;n++){var u=r.length;if(!u||!t)r.push([e.start(n),e.end(n)]);else{var s=r[u-1],d=s[1],m=e.start(n);if(m-d<=t){var f=e.end(n);f>d&&(s[1]=f)}else r.push([e.start(n),e.end(n)])}}return r}},{key:"totalLength",value:function(e){return!e||!e.length?0:e.reduce(function(t,r){return t+=r[1]-r[0]},0)}},{key:"info",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(!e||!e.length)return{start:0,end:0,buffers:[]};for(var n=0,o=0,u=0,s=0,d=0,m=0,f=0,y=i.buffers(e,r),g=0,T=y.length;g<T;g++){var R=y[g];if(t+r>=R[0]&&t<=R[1])n=R[0],o=R[1],u=g;else if(t+r<R[0]){s=R[0],d=R[1];break}else t+r>R[1]&&(m=R[0],f=R[1])}return{start:n,end:o,index:u,buffers:y,nextStart:s,nextEnd:d,prevStart:m,prevEnd:f,currentTime:t,behind:t-n,remaining:o?o-t:0,length:i.totalLength&&i.totalLength(y)}}},{key:"isBuffered",value:function(e,t){if(e){var r=i.get(e);if(r!=null&&r.length){for(var n=0;n<r.length;n++)if(t>=r.start(n)&&t<=r.end(n))return!0}}return!1}}]),i}(),Ye=typeof window<"u",U,b={MANIFEST:"manifest",NETWORK:"network",NETWORK_TIMEOUT:"network_timeout",NETWORK_FORBIDDEN:"network_forbidden",NETWORK_NOTFOUND:"network_notfound",NETWROK_RANGE_NOT_SATISFIABLE:"network_range_not_satisfiable",DEMUX:"demux",REMUX:"remux",MEDIA:"media",DRM:"drm",OTHER:"other",RUNTIME:"runtime",SUB_TYPES:{FLV:"FLV",HLS:"HLS",MP4:"MP4",FMP4:"FMP4",MSE_ADD_SB:"MSE_ADD_SB",MSE_APPEND_BUFFER:"MSE_APPEND_BUFFER",MSE_OTHER:"MSE_OTHER",MSE_FULL:"MSE_FULL",MSE_CHANGE_TYPE:"MSE_CHANGE_TYPE",OPTION:"OPTION",DASH:"DASH",LICENSE:"LICENSE",CUSTOM_LICENSE:"CUSTOM_LICENSE",MSE_HIJACK:"MSE_HIJACK",EME_HIJACK:"EME_HIJACK",SIDX:"SIDX",NO_CANPLAY_ERROR:"NO_CANPLAY_ERROR",BUFFERBREAK_ERROR:"BUFFERBREAK_ERROR",WAITING_TIMEOUT_ERROR:"WAITING_TIMEOUT_ERROR",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_CODEC_NOT_SUPPORTED:"MEDIA_ERR_CODEC_NOT_SUPPORTED",MEDIA_ERR_URL_EMPTY:"MEDIA_ERR_URL_EMPTY"}},Ee=(U={},c(U,b.MANIFEST,{HLS:1100,DASH:1200}),c(U,b.NETWORK,2100),c(U,b.NETWORK_TIMEOUT,2101),c(U,b.NETWORK_FORBIDDEN,2103),c(U,b.NETWORK_NOTFOUND,2104),c(U,b.NETWROK_RANGE_NOT_SATISFIABLE,2116),c(U,b.DEMUX,{FLV:3100,HLS:3200,MP4:3300,FMP4:3400,SIDX:3410}),c(U,b.REMUX,{FMP4:4100,MP4:4200}),c(U,b.MEDIA,{MEDIA_ERR_ABORTED:5101,MEDIA_ERR_NETWORK:5102,MEDIA_ERR_DECODE:5103,MEDIA_ERR_SRC_NOT_SUPPORTED:5104,MEDIA_ERR_CODEC_NOT_SUPPORTED:5105,MEDIA_ERR_URL_EMPTY:5106,MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202,MSE_FULL:5203,MSE_HIJACK:5204,MSE_CHANGE_TYPE:5205,EME_HIJACK:5301}),c(U,b.DRM,{LICENSE:7100,CUSTOM_LICENSE:7200}),c(U,b.OTHER,8e3),c(U,b.RUNTIME,{NO_CANPLAY_ERROR:9001,BUFFERBREAK_ERROR:9002,WAITING_TIMEOUT_ERROR:9003}),U),Y=function(i){ue(e,i);var a=ce(e);function e(t,r,n,o,u){var s;return B(this,e),s=a.call(this,u||(n==null?void 0:n.message)),s.errorType=t===b.NETWORK_TIMEOUT?b.NETWORK:t,s.originError=n,s.ext=o,s.errorCode=Ee[t][r]||Ee[t],s.errorMessage=s.message,s.errorCode||(s.errorType=b.OTHER,s.errorCode=Ee[s.errorType]),s}return x(e,null,[{key:"create",value:function(r,n,o,u,s){return r instanceof e?r:(r instanceof Error&&(o=r,r=""),r||(r=b.OTHER),new e(r,n,o,u,s))}},{key:"network",value:function(r){var n;return new e(r!=null&&r.isTimeout?b.NETWORK_TIMEOUT:b.NETWORK,null,r instanceof Error?r:null,{url:r==null?void 0:r.url,response:r==null?void 0:r.response,httpCode:r==null||(n=r.response)===null||n===void 0?void 0:n.status})}}]),e}(ve(Error)),he={DEBUG:1,LOG:2,WARN:3,ERROR:4},Qe=200*1024,Je=["Boolean","Number","String","Undefined","Null","Date","Object"],pe=function(){function i(a,e){B(this,i),this.name=a||"",this._prefix="[".concat(this.name,"]"),this.logCacheLevel=(e==null?void 0:e.logCacheLevel)||3,this.logMaxSize=(e==null?void 0:e.logMaxSize)||Qe,this.logSize=0,this.logTextArray=[]}return x(i,[{key:"debug",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.logCache.apply(this,[he.DEBUG].concat(r)),!i.disabled&&(e=console).debug.apply(e,["[".concat(ie(),"]"),this._prefix].concat(r))}},{key:"log",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.logCache.apply(this,[he.LOG].concat(r)),!i.disabled&&(e=console).log.apply(e,["[".concat(ie(),"]"),this._prefix].concat(r))}},{key:"warn",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.logCache.apply(this,[he.WARN].concat(r)),!i.disabled&&(e=console).warn.apply(e,["[".concat(ie(),"]"),this._prefix].concat(r))}},{key:"error",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.logCache.apply(this,[he.ERROR].concat(r)),!i.disabled&&(e=console).error.apply(e,["[".concat(ie(),"]"),this._prefix].concat(r))}},{key:"logCache",value:function(e){if(!(e<this.logCacheLevel)){var t="";try{for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var u=n.map(function(d){return Ue(d)});t="[".concat(ie(),"]")+this._prefix+JSON.stringify(u)}catch{return}if(e>=this.logCacheLevel&&(this.logSize+=t.length,this.logTextArray.push(t)),this.logSize>this.logMaxSize){var s=this.logTextArray.shift();this.logSize-=s.length}}}},{key:"getLogCache",value:function(){var e=this.logTextArray.join(`
`);return this.reset(),e}},{key:"reset",value:function(){this.logTextArray=[],this.logSize=0}},{key:"table",value:function(){var e;i.disabled||(e=console).table.apply(e,arguments)}},{key:"setLogLevel",value:function(e){this.logCacheLevel=e}}],[{key:"enable",value:function(){i.disabled=!1}},{key:"disable",value:function(){i.disabled=!0}}]),i}();c(pe,"disabled",!0);function ie(){return new Date().toLocaleString()}function Ze(i){if(Z(i)!=="object")return i;var a=Object.prototype.toString.call(i).slice(8,-1);switch(a){case"Array":case"Uint8Array":case"ArrayBuffer":return a+"["+i.length+"]";case"Object":return"{}";default:return a}}function Ue(i,a,e){e||(e=1),a||(a=2);var t={};if(!i||Z(i)!=="object")return i;var r=Object.prototype.toString.call(i).slice(8,-1);if(!Je.includes(r))return r;if(!(e>a)){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e===a?t[n]=Ze(i[n]):Z(i[n])==="object"?t[n]=Ue(i[n],a,e+1):t[n]=i[n]);return t}}function ne(){var i,a,e=new Promise(function(t,r){i=t,a=r});return e.used=!1,e.resolve=function(){return e.used=!0,i.apply(void 0,arguments)},e.reject=function(){return e.used=!0,a.apply(void 0,arguments)},e}function re(){try{return parseInt(performance.now(),10)}catch{return new Date().getTime()}}var et={stringify:function(a){try{return JSON.stringify(a)}catch{return""}},parse:function(a){try{return JSON.parse(a)}catch{return}}};function Pe(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;try{return Ye?i&&typeof ManagedMediaSource<"u"?ManagedMediaSource:window.MediaSource:null}catch{}}function ye(i){return/ManagedMediaSource/gi.test(Object.prototype.toString.call(i))}function tt(i){var a=[];if(i instanceof TimeRanges)for(var e=0;e<i.length;e++)a.push({start:i.start(e),end:i.end(e)});return a}var de={APPEND:"appendBuffer",REMOVE:"removeBuffer",UPDATE_DURATION:"updateDuration"},Be=function(){function i(a,e){var t=this;B(this,i),c(this,"media",null),c(this,"mediaSource",null),c(this,"_openPromise",ne()),c(this,"_queue",Object.create(null)),c(this,"_sourceBuffer",Object.create(null)),c(this,"_mseFullFlag",{}),c(this,"_st",0),c(this,"_opst",0),c(this,"_logger",null),c(this,"_config",null),c(this,"_url",null),c(this,"_onStartStreaming",function(){t._logger.debug("startstreaming")}),c(this,"_onEndStreaming",function(){t._logger.debug("endstreaming")}),c(this,"_onSBUpdateEnd",function(r){var n=t._queue[r];if(n){var o=n[0];if((o==null?void 0:o.opName)!==de.UPDATE_DURATION&&n.shift(),o){var u,s,d=re()-t._opst;t._logger.debug("UpdateEnd(".concat(r,"/").concat(o.opName,")"),et.stringify(tt((u=t._sourceBuffer[r])===null||u===void 0?void 0:u.buffered)),d,o.context),o.promise.resolve({name:o.opName,context:o.context,costtime:d});var m=(s=o.context)===null||s===void 0?void 0:s.callback;m&&typeof m=="function"&&m(o.context),t._startQueue(r)}}}),c(this,"_onSBUpdateError",function(r,n){var o=t._queue[r];if(o){var u=o[0];u&&(t._logger.error("UpdateError",r,u.opName,u.context),u.promise.reject(new Y(b.MEDIA,b.SUB_TYPES.MSE_APPEND_BUFFER,n)))}}),this._config=Object.assign(i.getDefaultConfig(),e),a&&this.bindMedia(a),this._logger=new pe("MSE"),this._config.openLog&&pe.enable()}return x(i,[{key:"isOpened",get:function(){var e;return((e=this.mediaSource)===null||e===void 0?void 0:e.readyState)==="open"}},{key:"hasOpTasks",get:function(){var e=this,t=!1;return Object.keys(this._queue).forEach(function(r){var n=e._queue[r];Array.isArray(n)&&(t||(t=n.length>0))}),t}},{key:"url",get:function(){return this._url}},{key:"duration",get:function(){var e;return((e=this.mediaSource)===null||e===void 0?void 0:e.duration)||-1}},{key:"isEnded",get:function(){return this.mediaSource?this.mediaSource.readyState==="ended":!1}},{key:"streaming",get:function(){return ye(this.mediaSource)?this.mediaSource.streaming:!0}},{key:"isFull",value:function(e){return e?this._mseFullFlag[e]:this._mseFullFlag[i.VIDEO]}},{key:"updateDuration",value:function(e){var t=this,r=this.mediaSource&&this.mediaSource.duration>e;if(this.mediaSource&&this.mediaSource.duration>e){var n=0;if(Object.keys(this._sourceBuffer).forEach(function(o){try{n=Math.max(t.bufferEnd(o)||0,n)}catch{}}),e<n)return Promise.resolve()}return this._enqueueBlockingOp(function(){if(t.isEnded){t._logger.debug("setDuration but ended");return}t.mediaSource&&(t.mediaSource.duration=e,t._logger.debug("setDuration",e))},de.UPDATE_DURATION,{isReduceDuration:r})}},{key:"open",value:function(){var e=this;if(this._openPromise.used&&!this.isOpened&&this.mediaSource){var t=this.mediaSource,r=function n(){var o=re()-e._st;e._logger.debug("sourceopen",o),t.removeEventListener("sourceopen",n),e._openPromise.resolve({costtime:o})};t.addEventListener("sourceopen",r),this._openPromise=ne()}return this._openPromise}},{key:"bindMedia",value:function(){var a=V(k().mark(function t(r){var n=this,o,u,s,d;return k().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(this.mediaSource||this.media)){f.next=3;break}return f.next=3,this.unbindMedia();case 3:if(o=Pe(this._config.preferMMS),!(!r||!o)){f.next=6;break}throw new Error("Param media or MediaSource does not exist");case 6:return this.media=r,u=this.mediaSource=new o,s=ye(u),this._st=re(),d=function y(){var g=re()-n._st;n._logger.debug("sourceopen"),u.removeEventListener("sourceopen",y),URL.revokeObjectURL(r.src),n._openPromise.resolve({costtime:g})},u.addEventListener("sourceopen",d),s&&(u.addEventListener("startstreaming",this._onStartStreaming),u.addEventListener("endstreaming",this._onEndStreaming)),this._url=URL.createObjectURL(u),r.src=this._url,r.disableRemotePlayback=s,f.abrupt("return",this._openPromise);case 17:case"end":return f.stop()}},t,this)}));function e(t){return a.apply(this,arguments)}return e}()},{key:"unbindMedia",value:function(){var a=V(k().mark(function t(){var r=this,n,o,u;return k().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this._openPromise.used||this._openPromise.resolve(),n=this.mediaSource,n){if(Object.keys(this._queue).forEach(function(m){var f=r._queue[m];f&&f.forEach(function(y){var g,T;return(g=y.promise)===null||g===void 0||(T=g.resolve)===null||T===void 0?void 0:T.call(g)})}),o=!!this.media&&this.media.readyState>=1,u=n.readyState==="open",o&&u)try{n.endOfStream()}catch{}Object.keys(this._sourceBuffer).forEach(function(m){try{n.removeSourceBuffer(r._sourceBuffer[m])}catch{}}),ye(n)&&(n.removeEventListener("startstreaming",this._onStartStreaming),n.removeEventListener("endstreaming",this._onEndStreaming))}if(this.media){this.media.disableRemotePlayback=!1,this.media.removeAttribute("src");try{this.media.load()}catch{}this.media=null}this.mediaSource=null,this._openPromise=ne(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 8:case"end":return d.stop()}},t,this)}));function e(){return a.apply(this,arguments)}return e}()},{key:"createSource",value:function(e,t){if(!(this._sourceBuffer[e]||!this.mediaSource)){var r;try{r=this._sourceBuffer[e]=this.mediaSource.addSourceBuffer(t)}catch(n){throw new Y(b.MEDIA,b.SUB_TYPES.MSE_ADD_SB,n)}r.mimeType=t,r.addEventListener("updateend",this._onSBUpdateEnd.bind(this,e)),r.addEventListener("error",this._onSBUpdateError.bind(this,e))}}},{key:"changeType",value:function(e,t){var r=this,n=this._sourceBuffer[e];return!this.mediaSource||!n||n.mimeType===t?Promise.resolve():typeof n.changeType!="function"?Promise.reject(new Y(b.MEDIA,b.SUB_TYPES.MSE_CHANGE_TYPE,new Error("changeType is not a function"))):this._enqueueOp(e,function(){try{n.changeType(t)}catch(o){throw new Y(b.MEDIA,b.SUB_TYPES.MSE_CHANGE_TYPE,o)}n.mimeType=t,r._onSBUpdateEnd(e)},"changeType",{mimeType:t})}},{key:"createOrChangeSource",value:function(e,t){return this.createSource(e,t),this.changeType(e,t)}},{key:"append",value:function(e,t,r){var n=this;return!t||!t.byteLength||!this._sourceBuffer[e]?Promise.resolve():this._enqueueOp(e,function(){var o;!n.mediaSource||n.media.error||(n._logger.debug("MSE APPEND START",r),n._opst=re(),(o=n._sourceBuffer[e])===null||o===void 0||o.appendBuffer(t))},de.APPEND,r)}},{key:"remove",value:function(e,t,r,n){var o=this,u=!1;return this._mseFullFlag[e]&&(u=!0),this._enqueueOp(e,function(){if(!(!o.mediaSource||o.media.error)){var s=o._sourceBuffer[e];if(t>=r||!s){o._onSBUpdateEnd(e);return}o._opst=re(),o._logger.debug("MSE REMOVE START",e,t,r,n),s.remove(t,r)}},de.REMOVE,n,u)}},{key:"clearBuffer",value:function(e,t){var r=this,n;return Object.keys(this._sourceBuffer).forEach(function(o){n=r.remove(o,e,t)}),n||Promise.resolve()}},{key:"clearAllBuffer",value:function(){var e=this,t;return Object.keys(this._sourceBuffer).forEach(function(r){var n=e._sourceBuffer[r];t=e.remove(r,0,Q.end(Q.get(n)))}),t}},{key:"clearOpQueues",value:function(e,t){var r;this._logger.debug("MSE clearOpQueue START");var n=this._queue[e];if(t&&n){this._queue[e]=[];return}if(!(!n||!n[e]||n.length<5)){var o=[];n.forEach(function(u){u.context&&u.context.isinit&&o.push(u)}),this._queue[e]=n.slice(0,2),o.length>0&&(r=this._queue[e]).push.apply(r,o)}}},{key:"endOfStream",value:function(e){var t=this;return!this.mediaSource||this.mediaSource.readyState!=="open"?Promise.resolve():this._enqueueBlockingOp(function(){var r=t.mediaSource;!r||r.readyState!=="open"||(t._logger.debug("MSE endOfStream START"),e?r.endOfStream(e):r.endOfStream())},"endOfStream")}},{key:"setLiveSeekableRange",value:function(e,t){var r=this.mediaSource;e<0||t<e||!(r!=null&&r.setLiveSeekableRange)||r.readyState!=="open"||r.setLiveSeekableRange(e,t)}},{key:"getSourceBuffer",value:function(e){return this._sourceBuffer[e]}},{key:"buffered",value:function(e){return Q.get(this._sourceBuffer[e])}},{key:"bufferStart",value:function(e){return Q.start(this.buffered(e))}},{key:"bufferEnd",value:function(e){return Q.end(this.buffered(e))}},{key:"_enqueueOp",value:function(e,t,r,n,o){var u=this;if(!this.mediaSource)return Promise.resolve();var s=this._queue[e]=this._queue[e]||[],d={exec:t,promise:ne(),opName:r,context:n};return o?(s.splice(0,0,d),this._mseFullFlag[e]=!1,this._startQueue(e)):s.push(d),this.isOpened||this.isEnded?s.length===1&&this._startQueue(e):this._openPromise.then(function(){s.length===1&&u._startQueue(e)}),d.promise}},{key:"_enqueueBlockingOp",value:function(){var a=V(k().mark(function t(r,n,o){var u=this,s,d;return k().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.mediaSource){f.next=2;break}return f.abrupt("return",Promise.resolve());case 2:if(s=Object.keys(this._sourceBuffer),s.length){f.next=5;break}return f.abrupt("return",r());case 5:return d=[],s.forEach(function(y){var g=u._queue[y],T=ne();d.push(T),g.push({exec:function(){T.resolve()},promise:T,opName:n,context:o}),g.length===1&&u._startQueue(y)}),f.abrupt("return",Promise.all(d).then(function(){try{return r()}finally{s.forEach(function(y){var g=u._queue[y],T=u._sourceBuffer[y];g==null||g.shift(),(!T||!T.updating)&&u._startQueue(y)})}}));case 8:case"end":return f.stop()}},t,this)}));function e(t,r,n){return a.apply(this,arguments)}return e}()},{key:"_startQueue",value:function(e){var t=this._queue[e];if(t){var r=t[0];if(r&&!this._mseFullFlag[e])try{r.exec()}catch(n){n&&n.message&&n.message.indexOf("SourceBuffer is full")>=0?(this._mseFullFlag[e]=!0,r.context&&Z(r.context)==="object"&&(r.context.isFull=!0),this._logger.error("[MSE error],  context,",r.context," ,name,",r.opName,",err,SourceBuffer is full"),r.promise.reject(new Y(b.MEDIA,b.SUB_TYPES.MSE_FULL,n))):(this._logger.error(n),r.promise.reject(n.constructor===Y?n:new Y(b.MEDIA,b.SUB_TYPES.MSE_OTHER,n)),t.shift(),this._startQueue(e))}}}},{key:"setTimeoffset",value:function(e,t,r){var n=this;return this._enqueueOp(e,function(){t<0&&(t+=.001),n._sourceBuffer[e].timestampOffset=t,n._onSBUpdateEnd(e)},"setTimeoffset",r)}},{key:"abort",value:function(e,t){var r=this;return this.isOpened?this._enqueueOp(e,function(){r._sourceBuffer[e].abort(),r._onSBUpdateEnd(e)},"abort",t):Promise.resolve()}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"',t=Pe();if(!t)return!1;try{return t.isTypeSupported(e)}catch(r){return this._logger.error(e,r),!1}}},{key:"isMMSOnly",value:function(){return typeof ManagedMediaSource<"u"&&typeof MediaSource>"u"}},{key:"getDefaultConfig",value:function(){return{openLog:!1,preferMMS:!1}}}]),i}();c(Be,"VIDEO","video");c(Be,"AUDIO","audio");var J={FETCH:"fetch",XHR:"xhr"},se={ARRAY_BUFFER:"arraybuffer",TEXT:"text",JSON:"json"},q=function(i){ue(e,i);var a=ce(e);function e(t,r,n,o){var u;return B(this,e),u=a.call(this,o),c(p(u),"retryCount",0),c(p(u),"isTimeout",!1),c(p(u),"loaderType",J.FETCH),c(p(u),"startTime",0),c(p(u),"endTime",0),c(p(u),"options",{}),u.url=t,u.request=r,u.response=n,u}return x(e)}(ve(Error)),xe=Object.prototype.toString;function rt(i){return i!==null&&Z(i)==="object"}function Me(i){if(xe.call(i)!=="[object Object]")return!1;var a=Object.getPrototypeOf(i);return a===null||a===Object.prototype}function nt(i){return xe.call(i)==="[object Date]"}function je(i){if(!(!i||i[0]===null||i[0]===void 0||i[0]===0&&(i[1]===null||i[1]===void 0))){var a="bytes="+i[0]+"-";return i[1]&&(a+=i[1]),a}}function ke(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function He(i,a){if(i){if(!a)return i;var e,t=Object.keys(a).map(function(n){if(e=a[n],e!=null)return Array.isArray(e)?n=n+"[]":e=[e],e.map(function(o){return nt(o)?o=o.toISOString():rt(o)&&(o=JSON.stringify(o)),"".concat(ke(n),"=").concat(ke(o))}).join("&")}).filter(Boolean).join("&");if(t){var r=i.indexOf("#");r!==-1&&(i=i.slice(0,r)),i+=(i.indexOf("?")===-1?"?":"&")+t}return i}}function Se(i,a,e,t,r,n,o,u,s,d,m){r=r!=null?parseFloat(r):null,t=parseInt(t||"0",10),Number.isNaN(t)&&(t=0);var f={range:s,vid:d,index:u,contentLength:t,age:r,startTime:n,firstByteTime:o,endTime:Date.now(),priOptions:m};return{data:i,done:a,options:f,response:e}}function Te(i,a){return Math.round(i*8*1e3/a/1024)}var G={ERROR:"error",TTFB:"core.ttfb",LOAD_START:"core.loadstart",LOAD_RESPONSE_HEADERS:"core.loadresponseheaders",LOAD_COMPLETE:"core.loadcomplete",LOAD_RETRY:"core.loadretry",SOURCEBUFFER_CREATED:"core.sourcebuffercreated",MEDIASOURCE_OPENED:"core.mediasourceopened",ANALYZE_DURATION_EXCEEDED:"core.analyzedurationexceeded",APPEND_BUFFER:"core.appendbuffer",REMOVE_BUFFER:"core.removebuffer",BUFFEREOS:"core.buffereos",KEYFRAME:"core.keyframe",CHASEFRAME:"core.chaseframe",METADATA_PARSED:"core.metadataparsed",SEI:"core.sei",SEI_IN_TIME:"core.seiintime",FLV_SCRIPT_DATA:"core.flvscriptdata",LOWDECODE:"core.lowdecode",SWITCH_URL_SUCCESS:"core.switchurlsuccess",SWITCH_URL_FAILED:"core.switchurlfailed",SPEED:"core.speed",HLS_MANIFEST_LOADED:"core.hlsmanifestloaded",HLS_LEVEL_LOADED:"core.hlslevelloaded",DEMUXED_TRACK:"core.demuxedtrack",STREAM_EXCEPTION:"core.streamexception",LARGE_AV_FIRST_FRAME_GAP_DETECT:"LARGE_AV_FIRST_FRAME_GAP_DETECT",LARGE_VIDEO_DTS_GAP_DETECT:"LARGE_VIDEO_DTS_GAP_DETECT",LARGE_AUDIO_DTS_GAP_DETECT:"LARGE_AUDIO_DTS_GAP_DETECT",AUDIO_GAP_DETECT:"AUDIO_GAP_DETECT",AUDIO_OVERLAP_DETECT:"AUDIO_OVERLAP_DETECT",MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT:"MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT",REAL_TIME_SPEED:"real_time_speed"},Ce=2*1024*1024,Oe=function(i){ue(e,i);var a=ce(e);function e(){var t;return B(this,e),t=a.call(this),c(p(t),"_abortController",null),c(p(t),"_timeoutTimer",null),c(p(t),"_reader",null),c(p(t),"_response",null),c(p(t),"_aborted",!1),c(p(t),"_index",-1),c(p(t),"_range",null),c(p(t),"_receivedLength",0),c(p(t),"_running",!1),c(p(t),"_logger",null),c(p(t),"_vid",""),c(p(t),"_onProcessMinLen",0),c(p(t),"_onCancel",null),c(p(t),"_priOptions",null),t}return x(e,[{key:"load",value:function(r){var n,o=this,u=r.url,s=r.vid,d=r.timeout,m=r.responseType,f=r.onProgress,y=r.index,g=r.onTimeout,T=r.onCancel,R=r.range,S=r.transformResponse,F=r.request,j=r.params,$=r.logger,A=r.method,P=r.headers,K=r.body,X=r.mode,W=r.credentials,te=r.cache,L=r.redirect,le=r.referrer,h=r.referrerPolicy,l=r.onProcessMinLen,_=r.priOptions;this._logger=$,this._aborted=!1,this._onProcessMinLen=l,this._onCancel=T,this._abortController=typeof AbortController<"u"&&new AbortController,this._running=!0,this._index=y,this._range=R||[0,0],this._vid=s||u,this._priOptions=_||{};var E={method:A,headers:P,body:K,mode:X,credentials:W,cache:te,redirect:L,referrer:le,referrerPolicy:h,signal:(n=this._abortController)===null||n===void 0?void 0:n.signal},v=!1;clearTimeout(this._timeoutTimer),u=He(u,j);var O=je(R);O&&(F?P=F.headers:P=E.headers=E.headers||(Headers?new Headers:{}),Headers&&P instanceof Headers?P.append("Range",O):P.Range=O),d&&(this._timeoutTimer=setTimeout(function(){if(v=!0,o.cancel(),g){var M=new q(u,E,null,"timeout");M.isTimeout=!0,g(M,{index:o._index,range:o._range,vid:o._vid,priOptions:o._priOptions})}},d));var w=Date.now();return this._logger.debug("[fetch load start], index,",y,",range,",R),new Promise(function(M,N){fetch(F||u,F?void 0:E).then(function(){var C=V(k().mark(function H(D){var ge,z,me,Re;return k().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(clearTimeout(o._timeoutTimer),o._response=D,!(o._aborted||!o._running)){I.next=4;break}return I.abrupt("return");case 4:if(S&&(D=S(D,u)||D),D.ok){I.next=7;break}throw new q(u,E,D,"bad network response");case 7:if(ge=Date.now(),m!==se.TEXT){I.next=15;break}return I.next=11,D.text();case 11:z=I.sent,o._running=!1,I.next=37;break;case 15:if(m!==se.JSON){I.next=22;break}return I.next=18,D.json();case 18:z=I.sent,o._running=!1,I.next=37;break;case 22:if(!f){I.next=29;break}return o.resolve=M,o.reject=N,o._loadChunk(D,f,w,ge),I.abrupt("return");case 29:return I.next=31,D.arrayBuffer();case 31:z=I.sent,z=new Uint8Array(z),o._running=!1,me=Date.now()-w,Re=Te(z.byteLength,me),o.emit(G.REAL_TIME_SPEED,{speed:Re,len:z.byteLength,time:me,vid:o._vid,index:o._index,range:o._range,priOptions:o._priOptions});case 37:o._logger.debug("[fetch load end], index,",y,",range,",R),M(Se(z,!0,D,D.headers.get("Content-Length"),D.headers.get("age"),w,ge,y,R,o._vid,o._priOptions));case 39:case"end":return I.stop()}},H)}));return function(H){return C.apply(this,arguments)}}()).catch(function(C){var H;clearTimeout(o._timeoutTimer),o._running=!1,!(o._aborted&&!v)&&(C=C instanceof q?C:new q(u,E,null,(H=C)===null||H===void 0?void 0:H.message),C.startTime=w,C.endTime=Date.now(),C.isTimeout=v,C.options={index:o._index,range:o._range,vid:o._vid,priOptions:o._priOptions},N(C))})})}},{key:"cancel",value:function(){var t=V(k().mark(function n(){return k().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!this._aborted){u.next=2;break}return u.abrupt("return");case 2:if(this._aborted=!0,this._running=!1,!this._response){u.next=14;break}if(u.prev=5,!this._reader){u.next=9;break}return u.next=9,this._reader.cancel();case 9:u.next=13;break;case 11:u.prev=11,u.t0=u.catch(5);case 13:this._response=this._reader=null;case 14:if(this._abortController){try{this._abortController.abort()}catch{}this._abortController=null}this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions});case 16:case"end":return u.stop()}},n,this,[[5,11]])}));function r(){return t.apply(this,arguments)}return r}()},{key:"_loadChunk",value:function(r,n,o,u){var s=this;if(!r.body||!r.body.getReader){this._running=!1;var d=new q(r.url,"",r,"onProgress of bad response.body.getReader");d.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this.reject(d);return}this._onProcessMinLen>0&&(this._cache=new Uint8Array(Ce),this._writeIdx=0);var m=this._reader=r.body.getReader(),f,y,g,T=function(){var R=V(k().mark(function S(){var F,j,$,A,P,K,X,W;return k().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return y=Date.now(),L.prev=1,L.next=4,m.read();case 4:f=L.sent,g=Date.now(),L.next=13;break;case 8:return L.prev=8,L.t0=L.catch(1),g=Date.now(),s._aborted||(s._running=!1,L.t0.options={index:s._index,range:s._range,vid:s._vid,priOptions:s._priOptions},s.reject(L.t0)),L.abrupt("return");case 13:if(j=((F=s._range)===null||F===void 0?void 0:F.length)>0?s._range[0]:0,$=j+s._receivedLength,!s._aborted){L.next=19;break}return s._running=!1,n(void 0,!1,{range:[$,$],vid:s._vid,index:s._index,startTime:y,endTime:g,st:o,firstByteTime:u,priOptions:s._priOptions},r),L.abrupt("return");case 19:A=f.value?f.value.byteLength:0,s._receivedLength+=A,s._logger.debug("【fetchLoader,onProgress call】,task,",s._range,", start,",$,", end,",j+s._receivedLength,", done,",f.done),s._onProcessMinLen>0?s._writeIdx+A>=s._onProcessMinLen||f.done?(P=new Uint8Array(s._writeIdx+A),P.set(s._cache.slice(0,s._writeIdx),0),A>0&&P.set(f.value,s._writeIdx),s._writeIdx=0,s._logger.debug("【fetchLoader,onProgress enough】,done,",f.done,",len,",P.byteLength,", writeIdx,",s._writeIdx)):A>0&&s._writeIdx+A<Ce?(s._cache.set(f.value,s._writeIdx),s._writeIdx+=A,s._logger.debug("【fetchLoader,onProgress cache】,len,",A,", writeIdx,",s._writeIdx)):A>0&&(K=new Uint8Array(s._writeIdx+A+2048),s._logger.debug("【fetchLoader,onProgress extra start】,size,",s._writeIdx+A+2048,", datalen,",A,", writeIdx,",s._writeIdx),K.set(s._cache.slice(0,s._writeIdx),0),A>0&&K.set(f.value,s._writeIdx),s._writeIdx+=A,delete s._cache,s._cache=K,s._logger.debug("【fetchLoader,onProgress extra end】,len,",A,", writeIdx,",s._writeIdx)):P=f.value,(P&&P.byteLength>0||f.done)&&n(P,f.done,{range:[s._range[0]+s._receivedLength-(P?P.byteLength:0),s._range[0]+s._receivedLength],vid:s._vid,index:s._index,startTime:y,endTime:g,st:o,firstByteTime:u,priOptions:s._priOptions},r),f.done?(X=Date.now()-o,W=Te(s._receivedLength,X),s.emit(G.REAL_TIME_SPEED,{speed:W,len:s._receivedLength,time:X,vid:s._vid,index:s._index,range:s._range,priOptions:s._priOptions}),s._running=!1,s._logger.debug("[fetchLoader onProgress end],task,",s._range,",done,",f.done),s.resolve(Se(f,!0,r,r.headers.get("Content-Length"),r.headers.get("age"),o,u,s._index,s._range,s._vid,s._priOptions))):T();case 25:case"end":return L.stop()}},S,null,[[1,8]])}));return function(){return R.apply(this,arguments)}}();T()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(r){this._running=r}}],[{key:"isSupported",value:function(){return typeof fetch<"u"}}]),e}(be);function it(i){return ae({loaderType:J.FETCH,retry:0,retryDelay:0,timeout:0,request:null,onTimeout:void 0,onProgress:void 0,onRetryError:void 0,transformRequest:void 0,transformResponse:void 0,transformError:void 0,responseType:se.TEXT,range:void 0,url:"",params:void 0,method:"GET",headers:{},body:void 0,mode:void 0,credentials:void 0,cache:void 0,redirect:void 0,referrer:void 0,referrerPolicy:void 0,integrity:void 0,onProcessMinLen:0},i)}var at=function(i){ue(e,i);var a=ce(e);function e(){var t;return B(this,e),t=a.call(this),c(p(t),"_xhr",null),c(p(t),"_aborted",!1),c(p(t),"_timeoutTimer",null),c(p(t),"_range",null),c(p(t),"_receivedLength",0),c(p(t),"_url",null),c(p(t),"_onProgress",null),c(p(t),"_index",-1),c(p(t),"_headers",null),c(p(t),"_currentChunkSizeKB",384),c(p(t),"_timeout",null),c(p(t),"_xhr",null),c(p(t),"_withCredentials",null),c(p(t),"_startTime",-1),c(p(t),"_loadCompleteResolve",null),c(p(t),"_loadCompleteReject",null),c(p(t),"_runing",!1),c(p(t),"_logger",!1),c(p(t),"_vid",""),c(p(t),"_responseType",void 0),c(p(t),"_credentials",void 0),c(p(t),"_method",void 0),c(p(t),"_transformResponse",void 0),c(p(t),"_firstRtt",void 0),c(p(t),"_onCancel",null),c(p(t),"_priOptions",null),t}return x(e,[{key:"load",value:function(r){var n=this;clearTimeout(this._timeoutTimer),this._logger=r.logger,this._range=r.range,this._onProgress=r.onProgress,this._index=r.index,this._headers=r.headers,this._withCredentials=r.credentials==="include"||r.credentials==="same-origin",this._body=r.body||null,r.method&&(this._method=r.method),this._timeout=r.timeout||null,this._runing=!0,this._vid=r.vid||r.url,this._responseType=r.responseType,this._firstRtt=-1,this._onTimeout=r.onTimeout,this._onCancel=r.onCancel,this._request=r.request,this._priOptions=r.priOptions||{},this._logger.debug("【xhrLoader task】, range",this._range),this._url=He(r.url,r.params);var o=Date.now();return new Promise(function(u,s){n._loadCompleteResolve=u,n._loadCompleteReject=s,n._startLoad()}).catch(function(u){if(clearTimeout(n._timeoutTimer),n._runing=!1,!n._aborted)throw u=u instanceof q?u:new q(n._url,n._request),u.startTime=o,u.endTime=Date.now(),u.options={index:n._index,vid:n._vid,priOptions:n._priOptions},u})}},{key:"_startLoad",value:function(){var r=null;if(this._responseType===se.ARRAY_BUFFER&&this._range&&this._range.length>1)if(this._onProgress){this._firstRtt=-1;var n=this._currentChunkSizeKB*1024,o=this._range[0]+this._receivedLength,u=this._range[1];n<this._range[1]-o&&(u=o+n),r=[o,u],this._logger.debug("[xhr_loader->],tast :",this._range,", SubRange, ",r)}else r=this._range,this._logger.debug("[xhr_loader->],tast :",this._range,", allRange, ",r);this._internalOpen(r)}},{key:"_internalOpen",value:function(r){var n=this;try{this._startTime=Date.now();var o=this._xhr=new XMLHttpRequest;o.open(this._method||"GET",this._url,!0),o.responseType=this._responseType,this._timeout&&(o.timeout=this._timeout),o.withCredentials=this._withCredentials,o.onload=this._onLoad.bind(this),o.onreadystatechange=this._onReadyStatechange.bind(this),o.onerror=function(d){var m,f,y;n._running=!1;var g=new q(n._url,n._request,d==null||(m=d.currentTarget)===null||m===void 0?void 0:m.response,"xhr.onerror.status:"+(d==null||(f=d.currentTarget)===null||f===void 0?void 0:f.status)+",statusText,"+(d==null||(y=d.currentTarget)===null||y===void 0?void 0:y.statusText));g.options={index:n._index,range:n._range,vid:n._vid,priOptions:n._priOptions},n._loadCompleteReject(g)},o.ontimeout=function(d){n.cancel();var m=new q(n._url,n._request,{status:408},"timeout");n._onTimeout&&(m.isTimeout=!0,n._onTimeout(m,{index:n._index,range:n._range,vid:n._vid,priOptions:n._priOptions})),m.options={index:n._index,range:n._range,vid:n._vid,priOptions:n._priOptions},n._loadCompleteReject(m)};var u=this._headers||{},s=je(r);s&&(u.Range=s),u&&Object.keys(u).forEach(function(d){o.setRequestHeader(d,u[d])}),this._logger.debug("[xhr.send->] tast,",this._range,",load sub range, ",r),o.send(this._body)}catch(d){d.options={index:this._index,range:r,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(d)}}},{key:"_onReadyStatechange",value:function(r){var n=r.target;n.readyState===2&&this._firstRtt<0&&(this._firstRtt=Date.now())}},{key:"_onLoad",value:function(r){var n,o=r.target.status;if(o<200||o>299){var u=new q(this._url,null,ae(ae({},r.target.response),{},{status:o}),"bad response,status:"+o);return u.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(u)}var s=null,d=!1,m,f=((n=this._range)===null||n===void 0?void 0:n.length)>0?this._range[0]:0;if(this._responseType===se.ARRAY_BUFFER){var y,g=new Uint8Array(r.target.response);if(m=f+this._receivedLength,g&&g.byteLength>0){this._receivedLength+=g.byteLength;var T=Date.now()-this._startTime,R=Te(this._receivedLength,T);this.emit(G.REAL_TIME_SPEED,{speed:R,len:this._receivedLength,time:T,vid:this._vid,index:this._index,range:[m,f+this._receivedLength],priOptions:this._priOptions})}s=g,((y=this._range)===null||y===void 0?void 0:y.length)>1&&this._range[1]&&this._receivedLength<this._range[1]-this._range[0]?d=!1:d=!0,this._logger.debug("[xhr load done->], tast :",this._range,", start",m,"end ",f+this._receivedLength,",dataLen,",g?g.byteLength:0,",receivedLength",this._receivedLength,",index,",this._index,", done,",d)}else d=!0,s=r.target.response;var S={ok:o>=200&&o<300,status:o,statusText:this._xhr.statusText,url:this._xhr.responseURL,headers:this._getHeaders(this._xhr),body:this._xhr.response};this._transformResponse&&(S=this._transformResponse(S,this._url)||S),this._onProgress&&this._onProgress(s,d,{index:this._index,vid:this._vid,range:[m,f+this._receivedLength],startTime:this._startTime,endTime:Date.now(),priOptions:this._priOptions},S),d?(this._runing=!1,this._loadCompleteResolve&&this._loadCompleteResolve(Se(this._onProgress?null:s,d,S,S.headers["content-length"],S.headers.age,this._startTime,this._firstRtt,this._index,this._range,this._vid,this._priOptions))):this._startLoad()}},{key:"cancel",value:function(){if(!this._aborted&&(this._aborted=!0,this._runing=!1,_e(ee(e.prototype),"removeAllListeners",this).call(this),this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions}),this._xhr))return this._xhr.abort()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(r){this._running=r}},{key:"_getHeaders",value:function(r){var n=r.getAllResponseHeaders().trim().split(`\r
`),o={},u=ze(n),s;try{for(u.s();!(s=u.n()).done;){var d=s.value,m=d.split(": ");o[m[0].toLowerCase()]=m.slice(1).join(": ")}}catch(f){u.e(f)}finally{u.f()}return o}}],[{key:"isSupported",value:function(){return typeof XMLHttpRequest<"u"}}]),e}(be),ot=["retry","retryDelay","onRetryError","transformError"],st=function(){function i(a,e){B(this,i),this.promise=ne(),this.alive=!!e.onProgress,!e.logger&&(e.logger=new pe("Loader")),this._loaderType=a,this._loader=a===J.FETCH&&typeof fetch<"u"?new Oe:new at,this._config=e,this._retryCount=0,this._retryTimer=null,this._canceled=!1,this._retryCheckFunc=e.retryCheckFunc,this._logger=e.logger}return x(i,[{key:"exec",value:function(){var e=this,t=this._config,r=t.retry,n=t.retryDelay,o=t.onRetryError,u=t.transformError,s=$e(t,ot),d=function(){var m=V(k().mark(function f(){var y,g,T;return k().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.prev=0,S.next=3,e._loader.load(s);case 3:y=S.sent,e.promise.resolve(y),S.next=27;break;case 7:if(S.prev=7,S.t0=S.catch(0),e._loader.running=!1,e._logger.debug("[task request catch err]",S.t0),!e._canceled){S.next=13;break}return S.abrupt("return");case 13:if(S.t0.loaderType=e._loaderType,S.t0.retryCount=e._retryCount,g=S.t0,u&&(g=u(g)||g),o&&e._retryCount>0&&o(g,e._retryCount,{index:s.index,vid:s.vid,range:s.range,priOptions:s.priOptions}),e._retryCount++,T=!0,e._retryCheckFunc&&(T=e._retryCheckFunc(S.t0)),!(T&&e._retryCount<=r)){S.next=26;break}return clearTimeout(e._retryTimer),e._logger.debug("[task request setTimeout],retry",e._retryCount,",retry range,",s.range),e._retryTimer=setTimeout(d,n),S.abrupt("return");case 26:e.promise.reject(g);case 27:case"end":return S.stop()}},f,null,[[0,7]])}));return function(){return m.apply(this,arguments)}}();return d(),this.promise}},{key:"cancel",value:function(){var a=V(k().mark(function t(){return k().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return clearTimeout(this._retryTimer),this._canceled=!0,this._loader.running=!1,n.abrupt("return",this._loader.cancel());case 4:case"end":return n.stop()}},t,this)}));function e(){return a.apply(this,arguments)}return e}()},{key:"running",get:function(){return this._loader&&this._loader.running}},{key:"loader",get:function(){return this._loader}}]),i}();function vt(i){return i&&!i.paused&&!i.ended&&i.playbackRate!==0&&i.readyState!==0}function pt(i){if(!i)return{};if(typeof i.getVideoPlaybackQuality=="function"){var a=i.getVideoPlaybackQuality();return{droppedVideoFrames:a.droppedVideoFrames||a.corruptedVideoFrames,totalVideoFrames:a.totalVideoFrames,creationTime:a.creationTime}}return{droppedVideoFrames:i.webkitDroppedFrameCount,totalVideoFrames:i.webkitDecodedFrameCount,creationTime:performance.now()}}function gt(){for(var i=arguments.length,a=new Array(i),e=0;e<i;e++)a[e]=arguments[e];if(a=a.filter(Boolean),a.length<2)return a[0];var t=new Uint8Array(a.reduce(function(n,o){return n+o.byteLength},0)),r=0;return a.forEach(function(n){t.set(n,r),r+=n.byteLength}),t}function ut(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(a){return setTimeout(a,i)})}var mt=function(i){ue(e,i);var a=ce(e);function e(t){var r;return B(this,e),r=a.call(this,t),c(p(r),"type",J.FETCH),c(p(r),"_queue",[]),c(p(r),"_alive",[]),c(p(r),"_currentTask",null),c(p(r),"_finnalUrl",""),c(p(r),"_config",void 0),r._config=it(t),(r._config.loaderType===J.XHR||!Oe.isSupported())&&(r.type=J.XHR),r.log=t.logger,r}return x(e,[{key:"isFetch",value:function(){return this.type===J.FETCH}},{key:"load",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};typeof r=="string"||!r?o.url=r||o.url||this._config.url:o=r,o=Object.assign({},this._config,o),o.params&&(o.params=Object.assign({},o.params)),o.headers&&Me(o.headers)&&(o.headers=Object.assign({},o.headers)),o.body&&Me(o.body)&&(o.body=Object.assign({},o.body)),o.transformRequest&&(o=o.transformRequest(o)||o),o.logger=this.log;var u=new st(this.type,o);return u.loader.on(G.REAL_TIME_SPEED,function(s){n.emit(G.REAL_TIME_SPEED,s)}),this._queue.push(u),this._queue.length===1&&(!this._currentTask||!this._currentTask.running)&&this._processTask(),u.promise}},{key:"cancel",value:function(){var t=V(k().mark(function n(){var o;return k().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=this._queue.map(function(d){return d.cancel()}).concat(this._alive.map(function(d){return d.cancel()})),this._currentTask&&o.push(this._currentTask.cancel()),this._queue=[],this._alive=[],s.next=6,Promise.all(o);case 6:return s.next=8,ut();case 8:case"end":return s.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"_processTask",value:function(){var r=this;if(this._currentTask=this._queue.shift(),!!this._currentTask){this._currentTask.alive&&this._alive.push(this._currentTask);var n=this._currentTask.exec().catch(function(o){});n&&typeof n.finally=="function"&&n.finally(function(){var o,u;(o=r._currentTask)!==null&&o!==void 0&&o.alive&&((u=r._alive)===null||u===void 0?void 0:u.length)>0&&(r._alive=r._alive.filter(function(s){return s&&s!==r._currentTask})),r._processTask()})}}}],[{key:"isFetchSupport",value:function(){return Oe.isSupported()}}]),e}(be),Et=function(){function i(){B(this,i),c(this,"_prevCurrentTime",0)}return x(i,[{key:"do",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(e){var o=e.currentTime,u=0;if(this._prevCurrentTime===o){var s=Q.info(Q.get(e),o);if(!s.buffers.length)return;r&&s.nextStart||s.nextStart&&s.nextStart-o<t?u=s.nextStart+.1:s.end&&s.end-o>n&&!e.seeking&&(u=o+.1)}this._prevCurrentTime=o,u&&o!==u&&(e.currentTime=u)}}}]),i}(),yt=function(){function i(a){var e=this;B(this,i),c(this,"_seiSet",new Set),this.emitter=a,a.on(G.SEI,function(t){t&&e._seiSet.add(t)})}return x(i,[{key:"throw",value:function(e,t){var r=this;if(!(e==null||!this._seiSet.size)){var n=e-.2,o=e+.2,u=[];this._seiSet.forEach(function(s){s.time>=n&&s.time<=o&&u.push(s)}),u.forEach(function(s){r._seiSet.delete(s),r.emitter.emit(G.SEI_IN_TIME,s)}),t&&this._seiSet.forEach(function(s){s.time<e-5&&r._seiSet.delete(s)})}}},{key:"reset",value:function(){this._seiSet.clear()}}]),i}(),ct=1e3,lt=50,ht=3,dt=3e3,St=function(){function i(a){B(this,i),c(this,"_chunkSpeed",0),c(this,"_chunkCache",[]),c(this,"_speeds",[]),c(this,"_totalSize",0),c(this,"_totalCost",0),this._opts=a||{}}return x(i,[{key:"addRecord",value:function(e,t){!e||!t||(this._speeds.push(8e3*e/t),this._speeds=this._speeds.slice(-ht))}},{key:"addChunkRecord",value:function(e,t){var r,n;if(!(!e||!t||e<(((r=this._opts)===null||r===void 0?void 0:r.skipChunkSize)||ct))){this._totalSize+=e,this._totalCost+=t,this._chunkSpeed=8e3*e/t,this._chunkCache.push({size:e,duration:t,timestamp:performance.now()});var o=((n=this._opts)===null||n===void 0?void 0:n.chunkCountForSpeed)||lt;this._chunkCache.length>o&&(this._chunkCache=this._chunkCache.slice(-o))}}},{key:"getAvgSpeed",value:function(){var e;if(!this._chunkCache.length&&!this._speeds.length)return 0;if(this._speeds.length)return this._speeds.reduce(function(u,s){return u+=s})/this._speeds.length;var t=this._chunkCache[this._chunkCache.length-1],r=performance.now()-t.timestamp;r>(((e=this._opts)===null||e===void 0?void 0:e.longtimeNoReceived)||dt)&&this._chunkCache.push({size:0,duration:r,timestamp:performance.now()});var n=this._chunkCache.reduce(function(u,s){return u+=s.size},0),o=this._chunkCache.reduce(function(u,s){return u+=s.duration},0);return 8e3*n/o}},{key:"getLatestSpeed",value:function(){return!this._chunkCache.length&&!this._speeds.length?0:this._speeds.length?this._speeds[this._speeds.length-1]:this._chunkSpeed}},{key:"getTotalSize",value:function(){return this._totalSize}},{key:"getTotalCost",value:function(){return this._totalCost}},{key:"reset",value:function(){this._chunkCache=[],this._speeds=[],this._totalSize=0,this._totalCost=0}}]),i}(),Ie=function(){function i(a){B(this,i),c(this,"encodeType",""),c(this,"audioCodec",""),c(this,"videoCodec",""),c(this,"domain",""),c(this,"fps",0),c(this,"bitrate",0),c(this,"width",0),c(this,"height",0),c(this,"samplerate",0),c(this,"channelCount",0),c(this,"gop",0),c(this,"_bitsAccumulateSize",0),c(this,"_bitsAccumulateDuration",0),c(this,"_startGopId",-1),this._timescale=a}return x(i,[{key:"getStats",value:function(){return{encodeType:this.encodeType,audioCodec:this.audioCodec,videoCodec:this.videoCodec,domain:this.domain,fps:this.fps,bitrate:this.bitrate,width:this.width,height:this.height,samplerate:this.samplerate,channelCount:this.channelCount,gop:this.gop}}},{key:"setEncodeType",value:function(e){this.encodeType=e}},{key:"setFpsFromScriptData",value:function(e){var t,r=e.data,n=r==null||(t=r.onMetaData)===null||t===void 0?void 0:t.framerate;n&&n>0&&n<100&&(this.fps=n)}},{key:"setVideoMeta",value:function(e){if(this.width=e.width,this.height=e.height,this.videoCodec=e.codec,this.encodeType=e.codecType,e.fpsNum&&e.fpsDen){var t=e.fpsNum/e.fpsDen;t>0&&t<100&&(this.fps=t)}}},{key:"setAudioMeta",value:function(e){this.audioCodec=e.codec,this.samplerate=e.sampleRate,this.channelCount=e.channelCount}},{key:"setDomain",value:function(e){this.domain=e.split("/").slice(2,3)[0]}},{key:"updateBitrate",value:function(e){var t=this;if((!this.fps||this.fps>=100)&&e.length){var r=e.reduce(function(n,o){return n+=o.duration},0)/e.length;this.fps=Math.round(this._timescale/r)}e.forEach(function(n){t._startGopId===-1&&(t._startGopId=n.gopId),n.gopId===t._startGopId&&t.gop++,t._bitsAccumulateDuration+=n.duration/(t._timescale/1e3),t._bitsAccumulateSize+=n.units.reduce(function(o,u){return o+=u.length},0),t._bitsAccumulateDuration>=1e3&&(t.bitrate=t._bitsAccumulateSize*8,t._bitsAccumulateDuration=0,t._bitsAccumulateSize=0)})}}]),i}(),Tt=function(){function i(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;B(this,i),c(this,"_core",null),c(this,"_samples",[]),this._core=a,this._timescale=e,this._stats=new Ie(e),this._bindEvents()}return x(i,[{key:"getStats",value:function(){var e,t,r,n,o,u,s,d,m,f,y,g=((e=this._core)===null||e===void 0?void 0:e.media)||{},T=g.currentTime,R=T===void 0?0:T,S=g.decodeFps,F=S===void 0?0:S;return ae(ae({},this._stats.getStats()),{},{downloadSpeed:((t=this._core)===null||t===void 0||(r=t.speedInfo)===null||r===void 0?void 0:r.call(t).speed)||0,avgSpeed:((n=this._core)===null||n===void 0||(o=n.speedInfo)===null||o===void 0?void 0:o.call(n).avgSpeed)||0,totalReceivedByte:((u=this._core)===null||u===void 0||(s=u.speedInfo)===null||s===void 0?void 0:s.call(u).totalSize)||0,totalReceivedCost:((d=this._core)===null||d===void 0||(m=d.speedInfo)===null||m===void 0?void 0:m.call(d).totalCost)||0,currentTime:R,bufferEnd:((f=this._core)===null||f===void 0||(y=f.bufferInfo())===null||y===void 0?void 0:y.remaining)||0,decodeFps:F})}},{key:"_bindEvents",value:function(){var e=this;this._core.on(G.DEMUXED_TRACK,function(t){var r=t.videoTrack;return e._stats.updateBitrate(r.samples)}),this._core.on(G.FLV_SCRIPT_DATA,function(t){e._stats.setFpsFromScriptData(t)}),this._core.on(G.METADATA_PARSED,function(t){t.type==="video"?e._stats.setVideoMeta(t.track):e._stats.setAudioMeta(t.track)}),this._core.on(G.TTFB,function(t){e._stats.setDomain(t.responseUrl)})}},{key:"reset",value:function(){this._samples=[],this._stats=new Ie(this._timescale)}}]),i}();export{Q as B,G as E,Et as G,pe as L,Be as M,mt as N,Y as S,b as a,St as b,gt as c,yt as d,Tt as e,pt as g,vt as i};
