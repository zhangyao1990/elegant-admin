
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import{c as f}from"./ccount-c2V3InAJ.js";import{u as k,a as p}from"./micromark-util-character-BqvJsIbw.js";import{f as d}from"./mdast-util-find-and-replace-BxKtL23s.js";const o="phrasing",s=["autolink","link","image","label"],z={transforms:[L],enter:{literalAutolink:g,literalAutolinkEmail:u,literalAutolinkHttp:u,literalAutolinkWww:u},exit:{literalAutolink:m,literalAutolinkEmail:A,literalAutolinkHttp:w,literalAutolinkWww:x}},H={unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:o,notInConstruct:s},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:o,notInConstruct:s},{character:":",before:"[ps]",after:"\\/",inConstruct:o,notInConstruct:s}]};function g(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function u(t){this.config.enter.autolinkProtocol.call(this,t)}function w(t){this.config.exit.autolinkProtocol.call(this,t)}function x(t){this.config.exit.data.call(this,t);const e=this.stack[this.stack.length-1];e.url="http://"+this.sliceSerialize(t)}function A(t){this.config.exit.autolinkEmail.call(this,t)}function m(t){this.exit(t)}function L(t){d(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,y],[/([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/g,E]],{ignore:["link","linkReference"]})}function y(t,e,i,n,a){let l="";if(!h(a)||(/^w/i.test(e)&&(i=e+i,e="",l="http://"),!P(i)))return!1;const r=W(i+n);if(!r[0])return!1;const c={type:"link",title:null,url:l+e+r[0],children:[{type:"text",value:e+r[0]}]};return r[1]?[c,{type:"text",value:r[1]}]:c}function E(t,e,i,n){return!h(n,!0)||/[-\d_]$/.test(i)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+i,children:[{type:"text",value:e+"@"+i}]}}function P(t){const e=t.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function W(t){const e=/[!"&'),.:;<>?\]}]+$/.exec(t);if(!e)return[t,void 0];t=t.slice(0,e.index);let i=e[0],n=i.indexOf(")");const a=f(t,"(");let l=f(t,")");for(;n!==-1&&a>l;)t+=i.slice(0,n+1),i=i.slice(n+1),n=i.indexOf(")"),l++;return[t,i]}function h(t,e){const i=t.input.charCodeAt(t.index-1);return(t.index===0||k(i)||p(i))&&(!e||i!==47)}export{z as a,H as g};
