
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

var Pe=Object.defineProperty;var K=t=>{throw TypeError(t)};var Se=(t,e,s)=>e in t?Pe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var p=(t,e,s)=>Se(t,typeof e!="symbol"?e+"":e,s),Y=(t,e,s)=>e.has(t)||K("Cannot "+s);var d=(t,e,s)=>(Y(t,e,"read from private field"),s?s.call(t):e.get(t)),_=(t,e,s)=>e.has(t)?K("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s);var n=(t,e,s)=>(Y(t,e,"access private method"),s);const re=t=>Array.isArray(t),ne=t=>re(t)?t:[t];let we=function(t){let e=function(c){return ne(c).forEach(g=>{var x;return f.set(Symbol((x=g.char)==null?void 0:x.innerText),o({...g}))}),this},s=()=>a().filter(c=>c.typeable),r=function(c,g){let x=[...f.keys()];f.set(x[c],o(g))},o=c=>(c.shouldPauseCursor=function(){return!!(this.typeable||this.cursorable||this.deletable)},c),u=function(){f.forEach(c=>delete c.done)},h=function(){f=new Map,e(t)},l=()=>f,a=()=>Array.from(f.values()),m=c=>f.delete(c),v=(c=!1)=>c?a():a().filter(g=>!g.done),S=(c,g=!1)=>g?f.delete(c):f.get(c).done=!0,f=new Map;return e(t),{add:e,set:r,wipe:h,done:S,reset:u,destroy:m,getItems:v,getQueue:l,getTypeable:s}};const oe="data-typeit-id",P="ti-cursor",Ee="END",Ce={started:!1,completed:!1,frozen:!1,destroyed:!1},E={breakLines:!0,cursor:{autoPause:!0,autoPauseDelay:500,animation:{frames:[0,0,1].map(t=>({opacity:t})),options:{iterations:1/0,easing:"steps(2, start)",fill:"forwards"}}},cursorChar:"|",cursorSpeed:1e3,deleteSpeed:null,html:!0,lifeLike:!0,loop:!1,loopDelay:750,nextStringDelay:750,speed:100,startDelay:250,startDelete:!1,strings:[],waitUntilVisible:!1,beforeString:()=>{},afterString:()=>{},beforeStep:()=>{},afterStep:()=>{},afterComplete:()=>{}},Ie=`[${oe}]:before {content: '.'; display: inline-block; width: 0; visibility: hidden;}`,M=t=>document.createElement(t),J=t=>document.createTextNode(t),ue=(t,e="")=>{let s=M("style");s.id=e,s.appendChild(J(t)),document.head.appendChild(s)},Z=t=>(re(t)||(t=[t/2,t/2]),t),ee=(t,e)=>Math.abs(Math.random()*(t+e-(t-e))+(t-e));let te=t=>t/2;function Ne(t){let{speed:e,deleteSpeed:s,lifeLike:r}=t;return s=s!==null?s:e/3,r?[ee(e,te(e)),ee(s,te(s))]:[e,s]}const le=t=>Array.from(t);let X=t=>([...t.childNodes].forEach(e=>{if(e.nodeValue){[...e.nodeValue].forEach(s=>{e.parentNode.insertBefore(J(s),e)}),e.remove();return}X(e)}),t);const ae=t=>{let e=document.implementation.createHTMLDocument();return e.body.innerHTML=t,X(e.body)};function he(t,e=!1,s=!1){let r=t.querySelector(`.${P}`),o=document.createTreeWalker(t,NodeFilter.SHOW_ALL,{acceptNode:l=>{var a,m;if(r&&s){if((a=l.classList)!=null&&a.contains(P))return NodeFilter.FILTER_ACCEPT;if(r.contains(l))return NodeFilter.FILTER_REJECT}return(m=l.classList)!=null&&m.contains(P)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),u,h=[];for(;u=o.nextNode();)u.originalParent||(u.originalParent=u.parentNode),h.push(u);return e?h.reverse():h}function Ae(t){return he(ae(t))}function Le(t,e=!0){return e?Ae(t):le(t).map(J)}const De=({index:t,newIndex:e,queueItems:s,cleanUp:r})=>{for(let o=t+1;o<e+1;o++)r(s[o][0])},de=t=>Number.isInteger(t),se=({queueItems:t,selector:e,cursorPosition:s,to:r})=>{if(de(e))return e*-1;let o=new RegExp(Ee,"i").test(r),u=e?[...t].reverse().findIndex(({char:l})=>{let a=l.parentElement,m=a.matches(e);return o&&m?!0:m&&a.firstChild.isSameNode(l)}):-1;u<0&&(u=o?0:t.length-1);let h=o?0:1;return u-s+h},qe=t=>(t.forEach(clearTimeout),[]),k=(t,e)=>new Array(e).fill(t);let $=t=>new Promise(e=>{requestAnimationFrame(async()=>{e(await t())})}),ce=t=>t==null?void 0:t.getAnimations().find(e=>e.id===t.dataset.tiAnimationId),fe=({cursor:t,frames:e,options:s})=>{let r=t.animate(e,s);return r.pause(),r.id=t.dataset.tiAnimationId,$(()=>{$(()=>{r.play()})}),r},ve=({cursor:t,options:e,cursorOptions:s})=>{if(!t||!s)return;let r=ce(t),o;r&&(e.delay=r.effect.getComputedTiming().delay,o=r.currentTime,r.cancel());let u=fe({cursor:t,frames:s.animation.frames,options:e});return o&&(u.currentTime=o),u},ie=t=>{var e;return(e=t.func)==null?void 0:e.call(null)},xe=async({index:t,queueItems:e,wait:s,cursor:r,cursorOptions:o})=>{let u=e[t][1],h=[],l=t,a=u,m=()=>a&&!a.delay,v=u.shouldPauseCursor()&&o.autoPause;for(;m();)h.push(a),m()&&l++,a=e[l]?e[l][1]:null;if(h.length)return await $(async()=>{for(let c of h)await ie(c)}),l-1;let S=ce(r),f;return S&&(f={...S.effect.getComputedTiming(),delay:v?o.autoPauseDelay:0}),await s(async()=>{S&&v&&S.cancel(),await $(()=>{ie(u)})},u.delay),await ve({cursor:r,options:f,cursorOptions:o}),t};const ke=(t,e)=>{new IntersectionObserver((r,o)=>{r.forEach(u=>{u.isIntersecting&&(e(),o.unobserve(t))})},{threshold:1}).observe(t)},Me=()=>Math.random().toString().substring(2,9),Q=t=>"value"in t;let Re=t=>Q(t)?le(t.value):he(t,!0).filter(e=>!(e.childNodes.length>0)),w=t=>typeof t=="function"?t():t,G=(t,e=document,s=!1)=>e[`querySelector${s?"All":""}`](t),Fe=t=>/body/i.test(t==null?void 0:t.tagName),He=(t,e)=>{if(Q(t)){t.value=`${t.value}${e.textContent}`;return}e.innerHTML="";let s=Fe(e.originalParent)?t:e.originalParent||t;s.insertBefore(e,G("."+P,s)||null)};const $e=t=>/<(.+)>(.*?)<\/(.+)>/.test(t.outerHTML),C=(t,e)=>Object.assign({},t,e);let Qe=t=>{var e,s;if(typeof t=="object"){let r={},{frames:o,options:u}=E.cursor.animation;return r.animation=t.animation||{},r.animation.frames=((e=t.animation)==null?void 0:e.frames)||o,r.animation.options=C(u,((s=t.animation)==null?void 0:s.options)||{}),r.autoPause=t.autoPause??E.cursor.autoPause,r.autoPauseDelay=t.autoPauseDelay||E.cursor.autoPauseDelay,r}return t===!0?E.cursor:t};const Be=(t,e)=>{if(!t)return;let s=t.parentNode;(s.childNodes.length>1||s.isSameNode(e)?t:s).remove()},_e=(t,e,s)=>{let r=e[s-1],o=G(`.${P}`,t);t=(r==null?void 0:r.parentNode)||t,t.insertBefore(o,r||null)};function ze(t){return typeof t=="string"?G(t):t}let Ue={"font-family":"","font-weight":"","font-size":"","font-style":"","line-height":"",color:"",transform:"translateX(-.125em)"},Ve=(t,e)=>{let r=`${`[${oe}='${t}']`} .${P}`,o=getComputedStyle(e),u=Object.entries(Ue).reduce((h,[l,a])=>`${h} ${l}: var(--ti-cursor-${l}, ${a||o[l]});`,"");ue(`${r} { display: inline-block; width: 0; ${u} }`,t)};function We(t){return t.replace(/<!--(.+?)-->/g,"").trim().split(/<br(?:\s*?)(?:\/)?>/)}let je=(t,e,s)=>Math.min(Math.max(e+t,0),s.length),Oe=(t,e,s)=>new Promise(r=>{let o=async()=>{await t(),r()};s.push(setTimeout(o,e||0))});var i,pe,I,z,me,U,V,W,R,y,ye,N,A,be,B,ge,Te,j,F,L,H,T,D,q,O,b;class Xe{constructor(e,s={}){_(this,i);p(this,"element");p(this,"timeouts");p(this,"cursorPosition");p(this,"predictedCursorPosition");p(this,"statuses",{started:!1,completed:!1,frozen:!1,destroyed:!1});p(this,"opts");p(this,"id");p(this,"queue");p(this,"cursor");p(this,"unfreeze",()=>{});p(this,"is",function(e){return this.statuses[e]});_(this,B,e=>{this.opts.cursor=Qe(e.cursor??E.cursor),this.opts.strings=n(this,i,ge).call(this,ne(this.opts.strings)),this.opts=C(this.opts,{html:!d(this,i,q)&&this.opts.html,nextStringDelay:Z(this.opts.nextStringDelay),loopDelay:Z(this.opts.loopDelay)})});this.opts=C(E,s),this.element=ze(e),this.timeouts=[],this.cursorPosition=0,this.unfreeze=()=>{},this.predictedCursorPosition=null,this.statuses=C({},Ce),this.id=Me(),this.queue=we([{delay:this.opts.startDelay}]),d(this,B).call(this,s),this.cursor=n(this,i,Te).call(this),this.element.dataset.typeitId=this.id,ue(Ie),this.opts.strings.length&&n(this,i,be).call(this)}go(){return this.statuses.started?this:(n(this,i,W).call(this),this.opts.waitUntilVisible?(ke(this.element,n(this,i,I).bind(this)),this):(n(this,i,I).call(this),this))}destroy(e=!0){this.timeouts=qe(this.timeouts),w(e)&&this.cursor&&n(this,i,H).call(this,this.cursor),this.statuses.destroyed=!0}reset(e){!this.is("destroyed")&&this.destroy(),e?(this.queue.wipe(),e(this)):this.queue.reset(),this.cursorPosition=0;for(let s in this.statuses)this.statuses[s]=!1;return this.element[n(this,i,R).call(this)?"value":"innerHTML"]="",this}type(e,s={}){e=w(e);let{instant:r}=s,o=n(this,i,N).call(this,s),h=Le(e,this.opts.html).map(a=>({func:()=>n(this,i,F).call(this,a),char:a,delay:r||$e(a)?0:n(this,i,T).call(this),typeable:a.nodeType===Node.TEXT_NODE})),l=[o[0],{func:async()=>await this.opts.beforeString(e,this)},...h,{func:async()=>await this.opts.afterString(e,this)},o[1]];return n(this,i,y).call(this,l,s)}break(e={}){return n(this,i,y).call(this,{func:()=>n(this,i,F).call(this,M("BR")),typeable:!0},e)}move(e,s={}){e=w(e);let r=n(this,i,N).call(this,s),{instant:o,to:u}=s,h=se({queueItems:this.queue.getTypeable(),selector:e===null?"":e,to:u,cursorPosition:d(this,i,D)}),l=h<0?-1:1;return this.predictedCursorPosition=d(this,i,D)+h,n(this,i,y).call(this,[r[0],...k({func:()=>n(this,i,z).call(this,l),delay:o?0:n(this,i,T).call(this),cursorable:!0},Math.abs(h)),r[1]],s)}exec(e,s={}){let r=n(this,i,N).call(this,s);return n(this,i,y).call(this,[r[0],{func:()=>e(this)},r[1]],s)}options(e,s={}){return e=w(e),n(this,i,A).call(this,e),n(this,i,y).call(this,{},s)}pause(e,s={}){return n(this,i,y).call(this,{delay:w(e)},s)}delete(e=null,s={}){e=w(e);let r=n(this,i,N).call(this,s),o=e,{instant:u,to:h}=s,l=this.queue.getTypeable(),a=o===null?l.length:de(o)?o:se({queueItems:l,selector:o,cursorPosition:d(this,i,D),to:h});return n(this,i,y).call(this,[r[0],...k({func:n(this,i,L).bind(this),delay:u?0:n(this,i,T).call(this,1),deletable:!0},a),r[1]],s)}freeze(){this.statuses.frozen=!0}flush(e=()=>{}){return n(this,i,W).call(this),n(this,i,I).call(this,!1).then(e),this}getQueue(){return this.queue}getOptions(){return this.opts}updateOptions(e){return n(this,i,A).call(this,e)}getElement(){return this.element}empty(e={}){return n(this,i,y).call(this,{func:n(this,i,pe).bind(this)},e)}}i=new WeakSet,pe=async function(){if(n(this,i,R).call(this)){this.element.value="";return}d(this,i,b).forEach(n(this,i,H).bind(this))},I=async function(e=!0){this.statuses.started=!0;let s=r=>{this.queue.done(r,!e)};try{let r=[...this.queue.getQueue()];for(let u=0;u<r.length;u++){let[h,l]=r[u];if(!l.done){if(!l.deletable||l.deletable&&d(this,i,b).length){let a=await n(this,i,U).call(this,u,r);De({index:u,newIndex:a,queueItems:r,cleanUp:s}),u=a}s(h)}}if(!e)return this;if(this.statuses.completed=!0,await this.opts.afterComplete(this),!this.opts.loop)throw"";let o=this.opts.loopDelay;n(this,i,V).call(this,async()=>{await n(this,i,me).call(this,o[0]),n(this,i,I).call(this)},o[1])}catch{}return this},z=async function(e){this.cursorPosition=je(e,this.cursorPosition,d(this,i,b)),_e(this.element,d(this,i,b),this.cursorPosition)},me=async function(e){let s=d(this,i,D);s&&await n(this,i,z).call(this,{value:s});let r=d(this,i,b).map(o=>[Symbol(),{func:n(this,i,L).bind(this),delay:n(this,i,T).call(this,1),deletable:!0,shouldPauseCursor:()=>!0}]);for(let o=0;o<r.length;o++)await n(this,i,U).call(this,o,r);this.queue.reset(),this.queue.set(0,{delay:e})},U=function(e,s){return xe({index:e,queueItems:s,wait:n(this,i,V).bind(this),cursor:this.cursor,cursorOptions:this.opts.cursor})},V=async function(e,s,r=!1){this.statuses.frozen&&await new Promise(o=>{this.unfreeze=()=>{this.statuses.frozen=!1,o()}}),r||await this.opts.beforeStep(this),await Oe(e,s,this.timeouts),r||await this.opts.afterStep(this)},W=async function(){if(!n(this,i,R).call(this)&&this.cursor&&this.element.appendChild(this.cursor),d(this,i,O)){Ve(this.id,this.element),this.cursor.dataset.tiAnimationId=this.id;let{animation:e}=this.opts.cursor,{frames:s,options:r}=e;fe({frames:s,cursor:this.cursor,options:{duration:this.opts.cursorSpeed,...r}})}},R=function(){return Q(this.element)},y=function(e,s){return this.queue.add(e),n(this,i,ye).call(this,s),this},ye=function(e={}){let s=e.delay;s&&this.queue.add({delay:s})},N=function(e={}){return[{func:()=>n(this,i,A).call(this,e)},{func:()=>n(this,i,A).call(this,this.opts)}]},A=async function(e){this.opts=C(this.opts,e)},be=function(){let e=this.opts.strings.filter(s=>!!s);e.forEach((s,r)=>{if(this.type(s),r+1===e.length)return;let o=this.opts.breakLines?[{func:()=>n(this,i,F).call(this,M("BR")),typeable:!0}]:k({func:n(this,i,L).bind(this),delay:n(this,i,T).call(this,1)},this.queue.getTypeable().length);n(this,i,j).call(this,o)})},B=new WeakMap,ge=function(e){let s=this.element.innerHTML;return s?(this.element.innerHTML="",this.opts.startDelete?(this.element.innerHTML=s,X(this.element),n(this,i,j).call(this,k({func:n(this,i,L).bind(this),delay:n(this,i,T).call(this,1),deletable:!0},d(this,i,b).length)),e):We(s).concat(e)):e},Te=function(){if(d(this,i,q))return null;let e=M("span");return e.className=P,d(this,i,O)?(e.innerHTML=ae(this.opts.cursorChar).innerHTML,e):(e.style.visibility="hidden",e)},j=function(e){let s=this.opts.nextStringDelay;this.queue.add([{delay:s[0]},...e,{delay:s[1]}])},F=function(e){He(this.element,e)},L=function(){d(this,i,b).length&&(d(this,i,q)?this.element.value=this.element.value.slice(0,-1):n(this,i,H).call(this,d(this,i,b)[this.cursorPosition]))},H=function(e){Be(e,this.element)},T=function(e=0){return Ne(this.opts)[e]},D=function(){return this.predictedCursorPosition??this.cursorPosition},q=function(){return Q(this.element)},O=function(){return!!this.opts.cursor&&!d(this,i,q)},b=function(){return Re(this.element)};export{Xe as T};
