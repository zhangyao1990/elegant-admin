
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import{_ as x}from"./index-qeCTDZwl.js";import{_ as D}from"./index.vue_vue_type_script_setup_true_lang-D6S2Ky_O.js";import{d as I,bo as g,bM as N,r as _,ai as y,a as w,S as L,U as P,f as r,_ as f,O as B,X as U,n as C}from"./@vue-B5ZJ3lyG.js";import{_ as K}from"./vue-esign-CYl9_Ryz.js";const O={class:"select-empty"},X={class:"select-close"},j={class:"table-box"},F=I({name:"TableSelect",__name:"index",props:g({requestApi:{},placeholder:{default:"请选择"},size:{default:"default"},clearable:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!1},collapseTagsTooltip:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},teleported:{type:Boolean,default:!0},selectWidth:{},tableWidth:{default:"100%"},columns:{default:[]},initTableParam:{default:{}},tableProps:{default:()=>({label:"id",value:"name"})}},{modelValue:{default:null},modelModifiers:{}}),emits:g(["change","reset"],["update:modelValue"]),setup(v,{emit:T}){const t=v,p=T,l=N(v,"modelValue"),o=_();function V(){o.value.clearSelection(),o.value.reset()}const m=_();function b(){m.value.blur()}function S(e){e&&V()}function k(){t.multiple?l.value=[]:l.value={},p("change",l.value)}function W(e){var s,u,i,c;const a=E(e.value);((u=(s=o.value)==null?void 0:s.selectedList)==null?void 0:u.some(d=>d[t.tableProps.value]===e.value))&&a&&((i=o==null?void 0:o.value)==null||i.toggleRowSelection(a,!1)),(c=l.value)==null||c.forEach((d,h)=>{d.value===e.value&&l.value.splice(h,1)}),p("change",l.value)}function E(e){return o.value.tableData.find(a=>a[t.tableProps.value]===e)}function R(e){return z(),{list:e&&e.records||[],total:e&&e.total||0}}function z(){t.multiple?C(()=>{var e,a;(a=(e=o.value)==null?void 0:e.tableData)==null||a.forEach(n=>{var s;(s=l.value)==null||s.forEach(u=>{var i,c,d;u.value===n[t.tableProps.value]&&((c=(i=o.value)==null?void 0:i.selectedList)!=null&&c.some($=>$[t.tableProps.value]===u.value)||(d=o==null?void 0:o.value)==null||d.toggleRowSelection(n,!0))})})}):C(()=>{var e;o.value.radio=((e=l.value)==null?void 0:e.value)||""})}function q(e,a){var n;t.multiple?((n=l.value)==null?void 0:n.some(u=>u.value===a[t.tableProps.value]))?(l.value.forEach((u,i)=>{var c;u.value===a[t.tableProps.value]&&((c=l.value)==null||c.splice(i,1))}),p("change",l.value)):(delete a.label,l.value.push({value:a[t.tableProps.value],label:a[t.tableProps.label],...a}),p("change",l.value)):(delete a.label,l.value={value:a[t.tableProps.value],label:a[t.tableProps.label],...a},p("change",l.value),b())}function A(e){var a,n;t.multiple&&(e.length>0?(e.forEach(s=>{var i;((i=l.value)==null?void 0:i.some(c=>c.value===s[t.tableProps.value]))||(delete s.label,l.value.push({value:s[t.tableProps.value],label:s[t.tableProps.label],...s}))}),p("change",l.value)):((n=(a=o.value)==null?void 0:a.tableData)==null||n.forEach(s=>{l.value.forEach((u,i)=>{u.value===s[t.tableProps.value]&&l.value.splice(i,1)})}),p("change",l.value)))}function M(){p("reset")}return(e,a)=>{const n=x,s=y("el-icon"),u=y("el-select");return l.value?(w(),L(u,{key:0,ref_key:"selectTableRef",ref:m,modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=i=>l.value=i),"popper-class":"tip-dropdown",teleported:e.teleported,"fit-input-width":e.fitInputWidth,style:B({width:e.selectWidth?`${e.selectWidth}`:"100%"}),class:"select-box",size:e.size,clearable:e.clearable,multiple:e.multiple,"collapse-tags":e.collapseTags,"collapse-tags-tooltip":e.collapseTagsTooltip,placeholder:e.placeholder,disabled:e.disabled,onRemoveTag:W,onVisibleChange:S,onClear:k},{empty:P(()=>[r("div",O,[r("div",X,[f(s,{class:"select-close__icon",onClick:b},{default:P(()=>[f(n,{name:"ep:close"})]),_:1})]),r("div",{class:"select-table",style:B({width:e.tableWidth?`${e.tableWidth}`:"100%"})},[r("div",j,[f(D,{ref_key:"proTableRef",ref:o,"search-col":{xs:1,sm:2,md:2,lg:2,xl:2},"init-param":e.initTableParam,"tool-button":!1,"data-callback":R,"highlight-current-row":"","page-layout":"total, prev, pager, next","request-api":e.requestApi,columns:e.columns,onReset:M,onSelect:q,onSelectAll:A},null,8,["init-param","request-api","columns"])])],4)])]),_:1},8,["modelValue","teleported","fit-input-width","style","size","clearable","multiple","collapse-tags","collapse-tags-tooltip","placeholder","disabled"])):U("",!0)}}}),Y=K(F,[["__scopeId","data-v-b7243561"]]);export{Y as _};
